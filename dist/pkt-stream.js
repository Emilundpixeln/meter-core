var R=Object.defineProperty;var yn=Object.getOwnPropertyDescriptor;var kn=Object.getOwnPropertyNames;var Tn=Object.prototype.hasOwnProperty;var Pn=(e,t)=>{for(var o in t)R(e,o,{get:t[o],enumerable:!0})},xn=(e,t,o,u)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of kn(t))!Tn.call(e,a)&&a!==o&&R(e,a,{get:()=>t[a],enumerable:!(u=yn(t,a))||u.enumerable});return e};var gn=e=>xn(R({},"__esModule",{value:!0}),e);var Jn={};Pn(Jn,{PKT:()=>E,PKTStream:()=>Mo});module.exports=gn(Jn);var bn=require("tiny-typed-emitter");var n=class{b;o;constructor(t){this.b=t,this.o=0}skip(t=0){this.o+=t}bool(){return this.u8()===1}u8(){return this.b.readUint8(this.o++)}i8(){return this.b.readInt8(this.o++)}u16(){let t=this.b.readUint16LE(this.o);return this.o+=2,t}i16(){let t=this.b.readInt16LE(this.o);return this.o+=2,t}u32(){let t=this.b.readUint32LE(this.o);return this.o+=4,t}i32(){let t=this.b.readInt32LE(this.o);return this.o+=4,t}f32(){let t=this.b.readFloatLE(this.o);return this.o+=4,t}u64(){let t=this.b.readBigUint64LE(this.o);return this.o+=8,t}i64(){let t=this.b.readBigInt64LE(this.o);return this.o+=8,t}string(t){let o=this.u16();if(o<=t){o=o*2;let u=this.b.toString("utf16le",this.o,this.o+o);return this.o+=o,u}return""}bytes(t=0,o,u){if(o&&t>o)return Buffer.alloc(0);u&&(t=t*u);let a=Buffer.from(this.b.subarray(this.o,this.o+t));return this.o+=t,a}array(t,o,u){return u&&t>u?[]:new Array(t).fill(void 0).map(o)}};function y(e){let t={};return t.points=e.u16(),t.level=e.u8(),t.id=e.u32(),t}function A(e){let t=new n(e),o={};return o.abilityDataList=t.array(t.u16(),()=>y(t),100),o}var L="PKTAbilityChangeNotify",w=14253;function jo(e){let t={};return t.level=e.u32(),t.featureType=e.u16(),t}function C(e){let t=new n(e),o={};return o.activeAbilityList=t.array(t.u16(),()=>jo(t),60),o.objectId=t.u64(),o}var M="PKTActiveAbilityNotify",j=49452;function F(e){let t=new n(e),o={};return o.addonFeatureIdList=t.bytes(t.u16(),200,4),o.objectId=t.u64(),o.addonSkillFeatureList=t.array(t.u16(),()=>{let u={};return u.addonSkillFeatureIdList=t.array(t.u16(),()=>t.u32(),5),u.skillId=t.u32(),u},200),o}var U="PKTAddonSkillFeatureChangeNotify",O=38079;function q(e){let t=new n(e),o={};return o.unk1_m=t.bytes(t.u32(),688),o.unk1=t.u32(),o}var z="PKTAuthTokenResult",Z=43790;function V(e){let t=new n(e),o={};return t.skip(1),o.type=t.u8(),o.paralyzationMaxPoint=t.u32(),o.paralyzationPoint=t.u32(),o.objectId=t.u64(),o}var H="PKTBlockSkillStateNotify",G=22660;function W(e){let t=new n(e),o={};return o.sourceId=t.u64(),t.skip(1),o.targetId=t.u64(),o.type=t.u32(),o}var Y="PKTCounterAttackNotify",$=40526;function J(e){let t=new n(e),o={};return o.unk0=t.u8(),t.bool()&&(o.unk2_0=t.u8()),t.bool()&&(o.unk4_0=t.u8()),o.unk5=t.u64(),o.unk6=t.u16(),t.bool()&&(o.unk8_0=t.u8()),o.sourceId=t.u64(),o.targetId=t.u64(),o.unk11=t.u32(),o.unk12=t.u32(),o}var Q="PKTDeathNotify",X=20353;var Sn=[0,31,28,31,30,31,30,31,31,30,31,30,31];function In(e){return!(e%4||!(e%100)&&e%400)}function Nn(e,t,o){if(e>99){if(e<1752||e==1752&&(t<9||t==9&&o<<14))return!1}else e+=1900;return o>0&&t<=12&&(o<=Sn[t]||o==29&&t==2&&In(e))}function Fo(e){let t=Number(e&0xffffffffn),o=Number(e>>32n&0xffffffffn),u=t&4095,a=(t&65535)>>12,m=t>>16&31;Nn(u,a,m)||(u=a=m=0);let d=t>>21&31,P=t>>26&63,x=o&63,h=o>>6&16383;return d<24&&P<60&&x<60&&h<1e3||(d=24,P=x=h=0),new Date(Date.UTC(u<=99?u+1900:u,a-1,m,d,P,x,h))}function c(e,t=0){let o=e.u16();return(o&4095)<2079?(e.o-=2,Fo(e.i64())):Fo(BigInt(o)&0xfffn|0x11000n)}function p(e){let t={};return t.expireTime=c(e),t.slot=e.u16(),t.itemTint=e.bytes(e.u16(),5,14),t.id=e.u32(),t.level=e.u16(),e.bool()&&(t.unk6_0=e.u8()),t}function tt(e){let t=new n(e),o={};return o.unk0=t.u32(),o.unk1=t.u32(),o.equipItemDataList=t.array(t.u16(),()=>p(t),32),o.objectId=t.u64(),o}var et="PKTEquipChangeNotify",ot=43149;function nt(e){let t=new n(e),o={};return o.objectId=t.u64(),o.equipLifeToolDataList=t.array(t.u16(),()=>p(t),9),o}var ut="PKTEquipLifeToolChangeNotify",rt=32073;function at(e){let t=new n(e),o={};return o.stance=t.u8(),o.objectId=t.u64(),t.skip(3),o}var it="PKTIdentityStanceChangeNotify",st=1874;function ft(e){let t=new n(e),o={};return o.struct_137=t.bytes(t.u16(),351,48),o.abilityDataList=t.array(t.u16(),()=>y(t),100),o}var mt="PKTInitAbility",ct=25688;function pt(e){let t=new n(e),o={};return o.struct_583=t.string(128),o.unk1=t.u32(),o.unk2=t.u8(),o.struct_30=t.array(t.u16(),()=>{let u={};return u.struct_567=t.string(32),u.struct_583=t.string(128),u.versionString=t.string(64),u},64),o.playerId=t.u64(),o.lostArkDateTime=c(t),o.unk6=t.u64(),o.unk7=t.u32(),o}var dt="PKTInitEnv",lt=854;function s(e){let t={};return e.bool()&&(t.unk1_0=e.u64()),t.endTick=e.u64(),t.stackCount=e.u8(),t.struct_437=e.bytes(e.u16(),8,7),t.sourceId=e.u64(),e.bool()&&(t.value=e.bytes(16)),t.totalTime=e.f32(),t.occurTime=c(e),t.effectInstanceId=e.u32(),t.skillLevel=e.u8(),t.statusEffectId=e.u32(),t}function _n(e){if(e.length===0)return 0n;if(e.length>8)throw new Error("Value is too large");let t=Buffer.alloc(8);return e.copy(t),t.readBigInt64LE()}function r(e,t=0){let o=e.u8(),u=e.bytes(o>>1&7),a=_n(u)<<4n|BigInt(o>>4);return o&1?-a:a}function k(e){let t={};return t.unk0=e.u8(),t.unk1=r(e),t.unk2=e.u64(),t.unk3=e.u8(),t.unk4=r(e),t.unk5=e.u8(),t.unk6=e.u16(),t}function yt(e){let t=new n(e),o={};return o.unk0=t.u8(),o.unk1=t.u32(),o.unk2=t.u32(),o.unk3=t.u64(),o.characterId=t.u64(),o.unk5=t.u64(),o.unk6=t.u8(),o.unk7=t.u8(),o.unk8=t.u32(),o.unk9=t.u32(),o.unk10=t.bytes(35),t.bool()&&(o.unk12_0=t.u32()),o.unk13=t.u32(),o.unk14=t.u8(),o.unk15=t.u32(),o.unk16=t.u8(),o.statusEffectDatas=t.array(t.u16(),()=>s(t),80),o.unk18=t.u8(),o.unk19=t.u8(),o.unk20=t.u8(),o.unk21=t.u8(),o.level=t.u16(),o.classId=t.u16(),o.struct_225=t.bytes(t.u16(),3,17),o.unk25=t.u8(),o.unk26=t.u64(),o.unk27=t.u8(),o.unk28=t.u8(),o.unk29=t.u16(),o.name=t.string(20),o.unk31=t.u32(),o.unk32=t.u16(),o.unk33=t.u32(),o.unk34=t.bytes(25),o.unk35=t.u32(),o.gearLevel=t.f32(),o.unk37=t.u8(),o.unk38=t.u32(),o.unk39=t.u16(),o.unk40=t.u8(),o.playerId=t.u64(),o.unk42=t.u64(),o.periodUpdateStatDataList=t.array(t.u16(),()=>k(t),5),o.unk44=t.u8(),o.unk45=t.u8(),o.struct_104=t.bytes(t.u16(),63),o.struct_336=t.bytes(t.u16(),104,30),o.unk48=t.u64(),o.unk49=t.u16(),o.unk50=t.u8(),o.unk51=t.u32(),o.statPair=t.array(t.u16(),()=>{let u={};return u.value=r(t),u.statType=t.u8(),u},153),o.unk53=t.u8(),o.struct_361=t.string(7),o.unk55=t.bytes(120),o.unk56=t.u8(),o.unk57=t.u8(),o}var kt="PKTInitPC",Tt=34824;function Uo(e){let t={},o=e.u16();return o===1&&(t.unk1_0=e.bytes(o)),t}function Oo(e){let t={};return t.unk0=e.u8(),t.unk1=e.u8(),t.unk2=e.u8(),t.unk3=e.u32(),t.struct_146=e.bytes(e.u16(),3,9),t.unk5=e.u32(),t.struct_145=Uo(e),t.unk7=e.u8(),t}function qo(e){let t={};return t.struct_257=e.bytes(e.u16(),2,9),t.unk1=e.u8(),t.unk2=e.u32(),t.unk3=e.u16(),t.struct_295=e.bytes(e.u16(),10,18),t.struct_387=e.bytes(e.u16(),2,10),t.unk6=e.u32(),t.unk7=e.u32(),t.unk8=e.u32(),t.struct_147=e.bytes(e.u16(),10,9),t.unk10=e.u32(),t.unk11=e.u64(),t.struct_233=e.array(e.u16(),()=>Oo(e),3),t.unk13=e.u32(),t}function zo(e){let t={};return t.unk0=e.u8(),t.unk1=e.bytes(3),t.unk2=e.u8(),t.struct_98=e.bytes(e.u32(),51),t.unk4=e.u16(),t.unk5=e.u8(),t.unk6=e.u16(),t.unk7=e.u16(),t}function S(e){let t={};return t.unk0=e.u8(),e.bool()&&(t.struct_738=zo(e)),t.struct_521=e.bytes(e.u16(),7),t}function Vo(e){let t={};return e.bool()&&(t.struct_229=e.bytes(e.u16(),2,32)),t.unk2=e.u32(),t.struct_268=e.bytes(e.u16(),3,21),t.unk4=e.u32(),t.itemTint=e.bytes(e.u16(),5,14),e.bool()&&(t.unk7_0=e.bytes(9)),t.unk8=e.u32(),e.bool()&&(t.struct_192=e.bytes(e.u16(),5,30),t.unk1_1=e.u32(),t.unk1_2=e.u32()),t.unk10=e.u32(),t.struct_431=e.bytes(e.u16(),3,10),t.struct_488=e.bytes(e.u16(),3,7),t.struct_270=e.bytes(e.u16(),10,29),t.unk14=e.u32(),t.unk15=e.u8(),e.bool()&&(t.struct_776=S(e)),t.unk18=e.u32(),t}function I(e){let t={};return t.npcId=e.u32(),t.isDead=e.bool(),t}function Go(e){let t={};return t.unk0=e.u32(),t.bossKillDataList=e.array(e.u16(),()=>I(e),3),t.struct_1=e.array(e.u16(),()=>{let o={};return o.unk1_0_0=e.u32(),o.struct_514=e.bytes(e.u16(),10),o},3),t.unk3=e.u8(),t.unk4=e.u8(),t}function Wo(e){let t={};return t.struct_232=e.bytes(e.u16(),5,7),t.struct_488=e.bytes(e.u16(),3,7),t.unk2=e.u8(),t.unk3=e.u8(),t.unk4=e.u8(),t.struct_23=e.array(e.u16(),()=>{let o={};return o.unk1_0_0=e.u8(),o.unk1_0_1=e.u16(),o.struct_230=e.string(2),o},20),t}function Yo(e){let t={},o=e.u8();return o===1&&(t.struct_654=qo(e)),o===2&&(t.struct_2=e.array(e.u16(),()=>{let u={};return u.unk1_0_0=e.u32(),u.unk1_0_1=e.u8(),u.unk1_0_2=e.u8(),u.struct_514=e.bytes(e.u16(),10),u},3),t.unk2_1=e.u8(),t.struct_133=e.bytes(e.u16(),3,6)),o===3&&(t.unk3_0=e.bytes(26)),o===4&&(t.unk4_0=e.u32(),t.unk4_1=e.bytes(e.u16(),10,13),t.unk4_2=e.bytes(e.u16(),10,13)),o===5&&(t.struct_653=Vo(e)),o===6&&(t.struct_598=Go(e)),o===7&&(t.unk7_0=e.bytes(9)),o===8&&(t.struct_646=Wo(e)),o===9&&(t.struct_776=S(e)),t}function $o(e){let t={};return e.u32()>0&&(t.serialNumber=e.u64(),t.id=e.u32(),t.level=e.u16(),t.slot=e.u16(),t.durability=e.u32(),t.unk1_6_m=e.u32(),t.flag=e.u32(),t.expireTime=c(e),t.lockUpdateTime=c(e),e.bool()&&(t.unk1_10_0=e.bytes(9)),t.unk1_11=e.u8(),t.unk1_12=e.u8(),t.unk1_13=e.u32(),t.struct_554=Yo(e),t.unk1_15=e.u32()),t}function Pt(e){let t=new n(e),o={};return o.storageType=t.u8(),o.itemDataList=t.array(t.u16(),()=>$o(t),80),o}var xt="PKTInitItem",gt=49088;function Jo(e){let t={};return t.unk0=e.u32(),t.unk1=e.u32(),e.bool()&&(t.unk3_0=e.bytes(9)),e.bool()&&(t.unk5_0=e.u32()),t.unk6=e.u32(),t}function Kt(e){let t=new n(e),o={};return o.unk0=t.u64(),o.unk1=t.u32(),o.unk2=t.u8(),t.bool()&&(o.unk4_0=t.u32()),o.struct_416=t.array(t.u16(),()=>Jo(t),300),o.addonSkillFeatureList=t.array(t.u16(),()=>{let u={};return u.addonSkillFeatureIdList=t.array(t.u16(),()=>t.u32(),5),u.skillId=t.u32(),u},200),o.struct_137=t.bytes(t.u16(),351,48),o.statPair=t.array(t.u16(),()=>{let u={};return u.value=r(t),u.statType=t.u8(),u},153),o.unk9=t.u8(),o.struct_225=t.bytes(t.u16(),3,17),o.unk11=t.u8(),o.unk12=t.u64(),o.statusEffectDatas=t.array(t.u16(),()=>s(t),80),o.addonFeatureIdList=t.bytes(t.u16(),200,4),o.abilityDataList=t.array(t.u16(),()=>y(t),100),o.struct_336=t.bytes(t.u16(),104,30),o}var St="PKTInitLocal",It=58281;function Nt(e){let t=new n(e),o={};return o.serverAddr=t.string(256),o.account_CharacterId1=t.u64(),o.account_CharacterId2=t.u64(),o.unk3=t.u32(),o}var _t="PKTMigrationExecute",Dt=59965;function Qo(e){let t={};return t.unk0=e.u8(),t.lostArkString=e.string(20),t.lookData=e.bytes(e.u32(),512),t.unk3=e.u64(),t.unk4=e.u8(),t.unk5=e.u8(),t.equipItemDataList=e.array(e.u16(),()=>p(e),32),t.unk7=e.u16(),t}function l(e,t=0){return e.u16()*(2*Math.PI)/65536}function Et(e){return e>>20===1?-((~e>>>0)+1&2097151):e}function i(e,t=0){let o=e.u64();return{x:Et(Number(o&0x1fffffn)),y:Et(Number(o>>21n&0x1fffffn)),z:Et(Number(o>>42n&0x1fffffn))}}function N(e){let t={};return t.statPair=e.array(e.u16(),()=>{let o={};return o.value=r(e),o.statType=e.u8(),o},153),e.bool()&&(t.struct_269=e.bytes(e.u16(),12,12)),e.bool()&&(t.unk4_0=e.u8()),t.spawnIndex=e.u32(),e.bool()&&(t.unk7_0=e.u64()),e.bool()&&(t.unk9_0=e.u8()),e.bool()&&(t.unk11_0=e.u32()),t.objectId=e.u64(),e.bool()&&(t.struct_332=e.bytes(e.u16(),11,9)),t.unk15=e.u8(),t.directionYaw=l(e),t.unk17=e.u8(),e.bool()&&(t.unk19_0=e.u32()),e.bool()&&(t.unk21_0=e.u16()),t.typeId=e.u32(),t.position=i(e),e.bool()&&(t.unk25_0=e.u8()),e.bool()&&(t.unk27_0=e.u32()),t.unk28=e.u8(),t.statusEffectDatas=e.array(e.u16(),()=>s(e),80),e.bool()&&(t.unk31_0=e.u8()),t.unk32=e.u8(),t.unk33=e.u8(),t.unk34=e.u8(),e.bool()&&(t.unk36_0=e.u8()),e.bool()&&(t.transitIndex=e.u32()),t.periodUpdateStatDataList=e.array(e.u16(),()=>k(e),5),e.bool()&&(t.struct_722=Qo(e)),t.level=e.u16(),e.bool()&&(t.unk44_0=e.u8()),e.bool()&&(t.unk46_0=e.u8()),e.bool()&&(t.balanceLevel=e.u16()),e.bool()&&(t.unk50_0=e.u32()),t}function ht(e){let t=new n(e),o={};return o.unk0=t.u8(),t.bool()&&(o.unk2_0=t.u8()),t.bool()&&(o.unk4_0=t.u64()),o.npcStruct=N(t),t.bool()&&(o.unk1_0=t.string(20),o.unk1_1=t.string(20)),o}var Rt="PKTNewNpc",Bt=48616;function At(e){let t=new n(e),o={};return t.skip(19),o.ownerId=t.u64(),t.skip(16),o.publishReason=t.u8(),o.npcData=N(t),o}var Lt="PKTNewNpcSummon",wt=31092;function tn(e){let t={};return t.unk29_m=e.u8(),t.addonFeatureIdList=e.bytes(e.u16(),200,4),t.unk5_m=e.u32(),t.guildId=e.u64(),t.unk4_m=e.u32(),t.name=e.string(20),t.avatarHide=e.u8(),t.maxItemLevel=e.f32(),t.unk1_m=e.u8(),t.petId=e.u32(),t.lookData=e.bytes(e.u32(),512),t.statusEffectDatas=e.array(e.u16(),()=>s(e),80),t.unk12=e.u32(),t.worldId=e.u8(),t.statPair=e.array(e.u16(),()=>{let o={};return o.value=r(e),o.statType=e.u8(),o},153),t.unk15=e.u32(),t.equipLifeToolDataList=e.array(e.u16(),()=>p(e),9),t.unk15_m=e.u8(),t.avgItemLevel=e.f32(),t.unk19=e.u8(),t.unk23_m=e.u8(),t.unk21=e.u32(),t.periodUpdateStatDataList=e.array(e.u16(),()=>k(e),5),t.playerId=e.u64(),t.equipItemDataList=e.array(e.u16(),()=>p(e),32),t.unk0_m=e.bytes(5),t.unk7_m=e.u32(),t.identityData=e.bytes(25),t.unk25_m=e.u8(),t.firstHonorTitleId=e.u16(),t.secondHonorTitleId=e.u16(),t.unk17_m=e.u8(),t.heading=l(e),t.guildName=e.string(20),t.addonSkillFeatureList=e.array(e.u16(),()=>{let o={};return o.addonSkillFeatureIdList=e.array(e.u16(),()=>e.u32(),5),o.skillId=e.u32(),o},200),t.position=i(e),t.unk32_m=e.u8(),t.level=e.u16(),t.unk45_m=e.u32(),e.bool()&&(t.grabbedData=e.bytes(12)),t.classId=e.u16(),t.rvRLevel=e.u16(),t.unk2_m=e.u8(),t.unk28_m=e.u8(),t.characterId=e.u64(),t}function en(e){let t={};return t.unk0=e.u32(),t.unk1=e.u32(),t.unk2=e.bytes(12),e.bool()&&(t.unk4_0=e.bytes(12)),t}function Ct(e){let t=new n(e),o={};return t.bool()&&(o.struct_60=t.array(t.u16(),()=>{let u={};return u.unk1_0_0=t.u64(),u.itemTint=t.bytes(t.u16(),5,14),u.unk1_0_2=t.u32(),u},5)),o.pcStruct=tn(t),o.unk0_m=t.u8(),t.bool()&&(o.unk3_0_m=t.u32()),o.unk2_m=t.u8(),t.bool()&&(o.trackMoveInfo=en(t)),t.bool()&&(o.unk4_0_m=t.bytes(12)),t.bool()&&(o.unk1_0=t.u32(),o.itemTint=t.bytes(t.u16(),5,14),o.unk1_2=t.u64()),t.bool()&&(o.unk5_0_m=t.bytes(20)),o}var Mt="PKTNewPC",jt=36402;function _(e,t=0){return{first:e.u8(),second:e.u8(),third:e.u8()}}function D(e,t=0){return{first:e.u16(),second:e.u16(),third:e.u16()}}function un(e){let t={};return t.chainSkillEffect=e.u32(),t.ownerId=e.u64(),t.unk2=e.u8(),t.unk3=e.u16(),t.tripodIndex=_(e),t.projectileId=e.u64(),t.unk6=e.u8(),t.unk7=e.u64(),t.unk8=e.u32(),t.unk9=e.u16(),e.bool()&&(t.unk11_0=e.u64()),e.bool()&&(t.struct_332=e.bytes(e.u16(),11,9)),t.skillEffect=e.u32(),t.skillLevel=e.u8(),t.tripodLevel=D(e),e.bool()&&(t.unk18_0=e.u32()),t.targetObjectId=e.u64(),t.unk20=e.u32(),t.unk21=e.u64(),t.skillId=e.u32(),t.unk23=e.u32(),t}function Ft(e){let t=new n(e),o={};return o.projectileInfo=un(t),o}var Ut="PKTNewProjectile",Ot=34607;function rn(e){let t={};return t.unk0=e.u8(),t.unk1=e.u16(),t.unk2=e.u32(),t.skillEffect=e.u32(),t.ownerId=e.u64(),t.position=i(e),e.bool()&&(t.struct_332=e.bytes(e.u16(),11,9)),t.unk8=e.u8(),t.unk9=e.u32(),t.unk10=e.u32(),t.objectId=e.u64(),t.skillId=e.u32(),t.unk13=e.u8(),t}function qt(e){let t=new n(e),o={};return o.trapData=rn(t),o.unk1=t.u8(),o.unk2=t.u8(),o}var zt="PKTNewTrap",Zt=8910;function Vt(e){let t=new n(e),o={};return o.enable=t.bool(),o.paralyzationMaxPoint=t.u32(),o.paralyzationPoint=t.u32(),t.skip(1),o.decreasePoint=t.u32(),o.noHitCheckTime=t.u32(),o.objectId=t.u64(),t.skip(1),o.hitCheckTime=t.u32(),o}var Ht="PKTParalyzationStateNotify",Gt=51798;function an(e){let t={};return t.zoneInstId=e.u64(),t.classId=e.u16(),t.unk2=e.u8(),t.name=e.string(20),t.unk4=e.u8(),t.transitIndex=e.u32(),t.auths=e.u8(),t.unk7=e.u8(),t.partyMemberNumber=e.u8(),t.unk9=e.u16(),t.characterLevel=e.u16(),t.unk11=e.u8(),t.position=i(e),t.worldId=e.u8(),t.zoneId=e.u32(),t.curHp=r(e),t.gearLevel=e.f32(),t.characterId=e.u64(),t.unk18=e.u8(),t.maxHp=r(e),t}function Wt(e){let t=new n(e),o={};return o.memberDatas=t.array(t.u16(),()=>an(t),40),o.lootGrade=t.u32(),o.partyType=t.u8(),o.partyInstanceId=t.u32(),o.raidInstanceId=t.u32(),o.partyLootType=t.u8(),o}var Yt="PKTPartyInfo",$t=33744;function Jt(e){let t=new n(e),o={};return o.name=t.string(20),o.partyLeaveType=t.u8(),o.partyInstanceId=t.u32(),o}var Qt="PKTPartyLeaveResult",Xt=45045;function te(e){let t=new n(e),o={};return o.passiveStatusEffectList=t.array(t.u16(),()=>t.u32(),10),o.unk0_m=t.u8(),o.objectId=t.u64(),o}var ee="PKTPartyPassiveStatusEffectAddNotify",oe=21311;function ne(e){let t=new n(e),o={};return o.passiveStatusEffectList=t.array(t.u16(),()=>t.u32(),10),o.objectId=t.u64(),o}var ue="PKTPartyPassiveStatusEffectRemoveNotify",re=44452;function ae(e){let t=new n(e),o={};return o.characterId=t.u64(),o.unk1=t.u64(),o.playerIdOnRefresh=t.u64(),o.unk3=t.u8(),o.statusEffectDatas=t.array(t.u16(),()=>s(t),80),o}var ie="PKTPartyStatusEffectAddNotify",se=11830;function fe(e){let t=new n(e),o={};return o.characterId=t.u64(),o.statusEffectIds=t.array(t.u16(),()=>t.u32(),80),o.reason=t.u8(),o.unk3=t.u64(),o}var me="PKTPartyStatusEffectRemoveNotify",ce=23135;function pe(e){let t=new n(e),o={};return t.skip(4),o.raidInstanceId=t.u32(),t.skip(16),o.characterId=t.u64(),t.skip(6),o.partyInstanceId=t.u32(),o}var de="PKTPartyStatusEffectResultNotify",le=43320;function be(e){let t=new n(e),o={};return o.passiveStatusEffectList=t.array(t.u16(),()=>t.u32(),10),o}var ye="PKTPassiveStatusEffectAddNotify",ke=39932;function Te(e){let t=new n(e),o={};return o.passiveStatusEffectList=t.array(t.u16(),()=>t.u32(),10),o}var Pe="PKTPassiveStatusEffectRemoveNotify",xe=13368;function ge(e){let t=new n(e),o={};return o.unk11_m=t.bool(),o.unk0_m=t.bool(),o.raidResult=t.u8(),o.bossKillDataList=t.array(t.u16(),()=>I(t),3),o.startTick=t.u64(),o.totalTime=t.u64(),o.unk1_m=t.bool(),o.unk4_m=t.u64(),o.unk5_m=t.u64(),o.endTick=t.u64(),o.unk6_m=t.u64(),o.raidId=t.u32(),o.braveHeartCount=t.u8(),o.initBraveHeartCount=t.u8(),o}var Ke="PKTRaidBegin",Se=13224;function Ie(e){let t=new n(e),o={};return o.unk0=t.bytes(7),o}var Ne="PKTRaidBossKillNotify",_e=50986;function De(e){let t=new n(e),o={};return o.unk0=t.u64(),o.unk1=t.u8(),o.struct_51=t.array(t.u16(),()=>{let u={};return u.unk1_0_0=r(t),u.unk1_0_1=t.u32(),u.struct_520=t.bytes(t.u16(),3),u.unk1_0_3=r(t),u},3),o.unk3=t.u64(),o.unk4=t.u64(),o.unk5=t.u64(),o.unk6=t.u8(),o.unk7=t.u8(),o}var ve="PKTRaidResult",Ee=54245;function sn(e){let t={};return t.unpublishReason=e.u8(),t.objectId=e.u64(),t}function he(e){let t=new n(e),o={};return o.unpublishedObjects=t.array(t.u16(),()=>sn(t),200),o}var Re="PKTRemoveObject",Be=41466;function Ae(e){let t=new n(e),o={};return t.skip(1),o.skillId=t.u32(),o.skillLevel=t.u8(),o.caster=t.u64(),t.skip(1),o}var Le="PKTSkillCastNotify",we=58699;function fn(e,t=0){let o={},u=e.u8();return u&1&&(o.moveTime=e.u32()),u&2&&(o.standUpTime=e.u32()),u&4&&(o.downTime=e.u32()),u&8&&(o.freezeTime=e.u32()),u&16&&(o.moveHeight=e.u32()),u&32&&(o.farmostDist=e.u32()),u&64&&(o.flag40=e.bytes(e.u16(),6)),o}function v(e){let t={};return t.modifier=e.u8(),t.unk3_m=e.u16(),e.bool()&&(t.damageAttr=e.u8()),t.maxHp=r(e),t.damage=r(e),t.targetId=e.u64(),t.damageType=e.u8(),t.curHp=r(e),t}function cn(e){let t={};return t.unk2_m=e.u64(),t.unk1_m=e.u8(),t.position=i(e),t.unk8_m=e.u16(),t.skillMoveOptionData=fn(e),t.skillDamageEvent=v(e),t.unk4_m=e.u16(),t.destination=i(e),t.unk3_m=e.u16(),t}function Ce(e){let t=new n(e),o={};return o.sourceId=t.u64(),o.skillDamageAbnormalMoveEvents=t.array(t.u16(),()=>cn(t),50),o.unk2_m=t.u32(),o.skillId=t.u32(),o.skillEffectId=t.u32(),o.unk1_m=t.u8(),o}var Me="PKTSkillDamageAbnormalMoveNotify",je=59272;function Fe(e){let t=new n(e),o={};return o.skillLevel=t.u8(),o.skillDamageEvents=t.array(t.u16(),()=>v(t),50),o.sourceId=t.u64(),o.skillEffectId=t.u32(),o.skillId=t.u32(),o}var Ue="PKTSkillDamageNotify",Oe=59818;function qe(e){let t=new n(e),o={};return t.skip(16),o.stage=t.u8(),t.skip(9),o.skillId=t.u32(),t.skip(11),o.sourceId=t.u64(),t.skip(4),o}var ze="PKTSkillStageNotify",Ze=22815;function pn(e,t=0){let o={},u=e.u8();return u&1&&(o.layerIndex=e.u8()),u&2&&(o.startStageIndex=e.u8()),u&4&&(o.transitIndex=e.u32()),u&8&&(o.stageStartTime=e.u32()),u&16&&(o.farmostDistance=e.u32()),u&32&&(o.tripodIndex=_(e)),u&64&&(o.tripodLevel=D(e)),o}function Ve(e){let t=new n(e),o={};return o.skillLevel=t.u8(),t.bool()&&(o.unk1_m=t.u32()),o.curPosition=i(t),t.bool()&&(o.pitchRotation=l(t)),o.aimTargetPosition=i(t),o.newDirectionYaw=l(t),t.bool()&&(o.aiStateId=t.u32()),o.sourceId=t.u64(),o.skillId=t.u32(),o.skillOptionData=pn(t),o.curDirectionYaw=l(t),o.newPosition=i(t),o}var He="PKTSkillStartNotify",Ge=52767;function We(e){let t=new n(e),o={};return o.unk0=t.u8(),o.statPairChangedList=t.array(t.u16(),()=>{let u={};return u.value=r(t),u.statType=t.u8(),u},153),o.objectId=t.u64(),o.unk3=t.array(t.u16(),()=>{let u={};return u.value=r(t),u.statType=t.u8(),u},153),t.bool()&&(o.unk5_0=t.u32()),o}var Ye="PKTStatChangeOriginNotify",$e=54143;function Je(e){let t=new n(e),o={};return o.new=t.bool(),t.bool()&&(o.unk2_0=t.u64()),o.statusEffectData=s(t),o.unk4=t.u64(),o.objectId=t.u64(),o}var Qe="PKTStatusEffectAddNotify",Xe=14366;function to(e){let t=new n(e),o={};return o.objectId=t.u64(),o.reason=t.u8(),o.statusEffectIds=t.array(t.u16(),()=>t.u32(),80),o}var eo="PKTStatusEffectRemoveNotify",oo=18762;function no(e){let t=new n(e),o={};return o.targetId=t.u64(),o.effectInstanceId=t.u32(),o.expirationTick=t.u64(),t.skip(2),o}var uo="PKTStatusEffectDurationNotify",ro=16838;function ao(e){let t=new n(e),o={};return t.skip(1),o.value=t.u32(),t.skip(4),o.objectId=t.u64(),o.characterId=t.u64(),o.effectInstanceId=t.u32(),t.skip(2),o}var io="PKTStatusEffectSyncDataNotify",so=15555;function fo(e){let t=new n(e),o={};return t.skip(1),o.triggerId=t.u32(),o.unk2_m=t.bool(),t.skip(1),o.step=t.u32(),o}var mo="PKTTriggerBossBattleStatus",co=42027;function po(e){let t=new n(e),o={};return o.involvedPCs=t.array(t.u16(),()=>t.u64(),40),o.unk0_m=t.u32(),o.packetResultCode=t.u32(),o.triggerId=t.u32(),o}var lo="PKTTriggerFinishNotify",bo=20612;function yo(e){let t=new n(e),o={};return o.sourceId=t.u64(),o.triggerSignalType=t.u32(),o.triggerId=t.u32(),o.involvedPCs=t.array(t.u16(),()=>t.u64(),40),o}var ko="PKTTriggerStartNotify",To=47665;function Po(e){let t=new n(e),o={};return o.position=t.u64(),o.statusEffectDatas=t.array(t.u16(),()=>s(t),80),o.curHp=r(t),o.maxHp=r(t),o.unk0_m=t.u32(),o.characterId=t.u64(),o}var xo="PKTTroopMemberUpdateMinNotify",go=3984;function Ko(e){let t=new n(e),o={};return o.identityGauge1=t.u32(),o.identityGauge2=t.u32(),o.identityGauge3=t.u32(),t.skip(1),o.playerId=t.u64(),t.skip(1),o}var So="PKTIdentityGaugeChangeNotify",Io=52368;function No(e){let t=new n(e),o={};return o.completeMembers=t.array(t.u16(),()=>t.u64(),40),o.zoneLevel=t.u8(),o.totalMembers=t.array(t.u16(),()=>t.u64(),40),o.zoneId=t.u32(),o.firstPCEnterTick=t.u64(),o.zoneInstId=t.u64(),o.loadComplete=t.bool(),o}var _o="PKTZoneMemberLoadStatusNotify",Do=24098;function vo(e){let t=new n(e),o={};return o.objectId=t.u64(),t.skip(1),o}var Eo="PKTZoneObjectUnpublishNotify",ho=36018;function dn(e){let t={};return t.stackCount=e.u8(),t.target=e.u8(),e.skip(4),t.id=e.u32(),t.instanceId=e.u32(),t}function Ro(e){let t=new n(e),o={};return o.zoneStatusEffectDataList=t.array(t.u16(),()=>dn(t),4),o}var Bo="PKTZoneStatusEffectAddNotify",Ao=41162;function Lo(e){let t=new n(e),o={};return t.skip(2),o.statusEffectId=t.u32(),t.skip(1),o}var wo="PKTZoneStatusEffectRemoveNotify",Co=22727;var ln=new Map([[w,[L,A]],[j,[M,C]],[O,[U,F]],[Z,[z,q]],[G,[H,V]],[$,[Y,W]],[X,[Q,J]],[ot,[et,tt]],[rt,[ut,nt]],[st,[it,at]],[ct,[mt,ft]],[lt,[dt,pt]],[Tt,[kt,yt]],[gt,[xt,Pt]],[It,[St,Kt]],[Dt,[_t,Nt]],[Bt,[Rt,ht]],[wt,[Lt,At]],[jt,[Mt,Ct]],[Ot,[Ut,Ft]],[Zt,[zt,qt]],[Gt,[Ht,Vt]],[$t,[Yt,Wt]],[Xt,[Qt,Jt]],[oe,[ee,te]],[re,[ue,ne]],[se,[ie,ae]],[ce,[me,fe]],[le,[de,pe]],[ke,[ye,be]],[xe,[Pe,Te]],[Se,[Ke,ge]],[_e,[Ne,Ie]],[Ee,[ve,De]],[Be,[Re,he]],[we,[Le,Ae]],[je,[Me,Ce]],[Oe,[Ue,Fe]],[Ze,[ze,qe]],[Ge,[He,Ve]],[$e,[Ye,We]],[Xe,[Qe,Je]],[oo,[eo,to]],[ro,[uo,no]],[so,[io,ao]],[co,[mo,fo]],[bo,[lo,po]],[To,[ko,yo]],[go,[xo,Po]],[Io,[So,Ko]],[Do,[_o,No]],[ho,[Eo,vo]],[Ao,[Bo,Ro]],[Co,[wo,Lo]]]);var Mo=class extends bn.TypedEmitter{#t;constructor(t){super(),this.#t=t}read(t){try{if(t.length<8)return!1;let o=t.readUInt8(7);if(o>2)return!1;let u=t.readUInt8(6);if(u>3)return!1;let a=t.subarray(8),m=t.readUInt16LE(4),d=ln.get(m);if(d){let[P,x]=d;this.emit(P,new E(Buffer.from(a),m,u,!!o,this.#t,x))}this.emit("*",a,m,u,!!o)}catch{return!1}}},E=class{#t;#o;#n;#u;#r;#a;constructor(t,o,u,a,m,d){this.#t=t,this.#o=o,this.#n=u,this.#u=a,this.#r=m,this.#a=d}#e;get parsed(){if(!this.#e)try{this.#e=this.#a(this.#r.decrypt(this.#t,this.#o,this.#n,this.#u))}catch(t){console.error(`[meter-core/pkt-stream] - ${t}`);return}return this.#e}};0&&(module.exports={PKT,PKTStream});
