var e=class{buffer;position;out;constructor(){this.buffer=null,this.position=0,this.out=[]}write(i){for(;i.length>0;){if(this.buffer){if(this.buffer.length<2){let t=this.buffer[0],h=(i[0]<<8)+t;this.buffer=Buffer.alloc(h),this.buffer[0]=t,this.position=1}let f=Math.min(i.length,this.buffer.length-this.position);i.copy(this.buffer,this.position,0,f),this.position+=f,this.position===this.buffer.length&&(this.out.push(this.buffer),this.buffer=null,this.position=0),i=i.subarray(f);continue}if(i.length<2){this.buffer=Buffer.from(i),this.position=i.length;break}let s=i.readUInt16LE(0);if(s===0){this.buffer=null;return}if(s>i.length){this.buffer=Buffer.alloc(s),i.copy(this.buffer),this.position=i.length;break}this.out.push(i.subarray(0,s)),i=i.subarray(s)}}read(){return this.out.shift()}};export{e as a};
