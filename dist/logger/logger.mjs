import{a as ha}from"../chunk-ZGEJ7KGT.mjs";import{$ as vo,A as $a,B as Ja,C as Qa,D as Xa,E as to,F as eo,G as ao,H as oo,I as io,J as ro,K as no,L as so,M as fo,N as uo,O as mo,P as yo,Q as po,R as co,S as lo,T as No,U as So,V as bo,W as go,X as Eo,Y as xo,Z as Io,_ as Po,a as Ca,aa as Do,b as Ka,ba as To,c as Wa,ca as Ro,d as wa,da as ko,e as ja,ea as Lo,f as Ma,fa as Ao,g as Ba,ga as ho,h as Fa,ha as Co,i as N,ia as Ko,j as S,ja as Wo,k as qa,ka as wo,l as Oa,la as jo,m as Za,ma as Mo,n as _a,na as Bo,o as Ua,p as i,pa as Fo,q as r,r as za,s as Va,t as Ha,u as Ga,v as m,w as y,x as l,y as d,z as Ya}from"../chunk-6CHOTYTZ.mjs";import"../chunk-7RMENK4B.mjs";import"../chunk-K7C7TUE5.mjs";import{TypedEmitter as Di}from"tiny-typed-emitter";var qo=new Map([[Wa,[0]],[wa,[1]],[ja,[2]],[Ma,[4]],[Ba,[5]],[Fa,[6]],[_a,[7]],[Ua,[8]],[za,[9]],[Ha,[10]],[Ga,[11]],[Ya,[12]],[$a,[13]],[Ja,[14]],[ao,[15]],[oo,[16]],[io,[17]],[ro,[18]],[no,[19]],[so,[20]],[fo,[21]],[uo,[22]],[mo,[23]],[yo,[24]],[po,[25]],[co,[26]],[lo,[27]],[No,[28]],[Eo,[29]],[xo,[30]],[Io,[31]],[Do,[32]],[To,[34]],[Ro,[35]],[ko,[36]],[Lo,[37]],[Ao,[38]],[ho,[39]],[Co,[40]],[Ko,[41]],[Wo,[42]],[wo,[43]],[jo,[44]],[Mo,[45]],[So,[46]],[Za,[47]],[qa,[48]],[Oa,[49]],[Va,[50]]]);function x(t,a){let e={};return e.points=t.u16(),e.id=t.u32(),e.level=t.u8(),e}function I(t,a){t.u16(a.points),t.u32(a.id),t.u8(a.level)}function q(t,a){let e={};return e.abilityDataList=t.array(t.u16(),()=>x(t,a),100),e}function O(t,a){t.array(a.abilityDataList,{maxLen:100,lenType:"u16"},e=>{I(t,e)})}var Z="AbilityChangeNotify";function Oo(t,a){let e={};return e.featureType=t.u16(),e.level=t.u32(),e}function Zo(t,a){t.u16(a.featureType),t.u32(a.level)}function _(t,a){let e={};return e.activeAbilityList=t.array(t.u16(),()=>Oo(t,a),60),e.objectId=t.u64(),e}function U(t,a){t.array(a.activeAbilityList,{maxLen:60,lenType:"u16"},e=>{Zo(t,e)}),t.u64(a.objectId)}var z="ActiveAbilityNotify";function V(t,a){let e={};return e.objectId=t.u64(),e.addonSkillFeatureList=t.array(t.u16(),()=>{let o={};return o.addonSkillFeatureIdList=t.array(t.u16(),()=>t.u32(),5),o.skillId=t.u32(),o},200),e}function H(t,a){t.u64(a.objectId),t.array(a.addonSkillFeatureList,{maxLen:200,lenType:"u16"},e=>{t.array(e.addonSkillFeatureIdList,{maxLen:5,lenType:"u16"},o=>{t.u32(o)}),t.u32(e.skillId)})}var G="AddonSkillFeatureChangeNotify";function Y(t,a){let e={};return e.paralyzationMaxPoint=t.u32(),e.type=t.u8(),e.objectId=t.u64(),e.paralyzationPoint=t.u32(),e}function $(t,a){t.u32(a.paralyzationMaxPoint),t.u8(a.type),t.u64(a.objectId),t.u32(a.paralyzationPoint)}var J="BlockSkillStateNotify";function Q(t,a){let e={};return e.sourceId=t.u64(),e.targetId=t.u64(),e.type=t.u32(),e}function X(t,a){t.u64(a.sourceId),t.u64(a.targetId),t.u32(a.type)}var tt="CounterAttackNotify";function et(t,a){let e={};return e.sourceId=t.u64(),e.targetId=t.u64(),e}function at(t,a){t.u64(a.sourceId),t.u64(a.targetId)}var ot="DeathNotify";function it(t,a){let e={};return e.abilityDataList=t.array(t.u16(),()=>x(t,a),100),e}function rt(t,a){t.array(a.abilityDataList,{maxLen:100,lenType:"u16"},e=>{I(t,e)})}var nt="InitAbility";function st(t,a){let e={};return e.playerId=t.u64(),e}function ft(t,a){t.u64(a.playerId)}var ut="InitEnv";function n(t,a){let e={};return e.skillLevel=t.u8(),e.occurTime=N(t,a),e.statusEffectId=t.u32(),e.sourceId=t.u64(),e.totalTime=t.f32(),e.endTick=t.u64(),t.bool()&&(e.value=t.bytes(16)),e.effectInstanceId=t.u32(),a>=1?e.stackCount=t.u8():e.stackCount=1,e}function s(t,a){t.u8(a.skillLevel),S(t,a.occurTime),t.u32(a.statusEffectId),t.u64(a.sourceId),t.f32(a.totalTime),t.u64(a.endTick),t.bool(a.value!==void 0)&&t.bytes(a.value,{length:16}),t.u32(a.effectInstanceId),t.u8(a.stackCount)}function mt(t,a){let e={};return e.statPair=t.array(t.u16(),()=>{let o={};return o.StatType=t.u8(),o.Value=i(t,a),o},152),e.name=t.string(20),e.level=t.u16(),e.statusEffectDatas=t.array(t.u16(),()=>n(t,a),80),e.characterId=t.u64(),e.gearLevel=t.f32(),e.playerId=t.u64(),e.classId=t.u16(),e}function yt(t,a){t.array(a.statPair,{maxLen:152,lenType:"u16"},e=>{t.u8(e.statType),r(t,e.value)}),t.string(a.name,20),t.u16(a.level),t.array(a.statusEffectDatas,{maxLen:80,lenType:"u16"},e=>{s(t,e)}),t.u64(a.characterId),t.f32(a.gearLevel),t.u64(a.playerId),t.u16(a.classId)}var pt="InitPC";function ct(t,a){let e={};return e.statPair=t.array(t.u16(),()=>{let o={};return o.statType=t.u8(),o.value=i(t,a),o},152),e.statusEffectDatas=t.array(t.u16(),()=>n(t,a),80),e.addonSkillFeatureList=t.array(t.u16(),()=>{let o={};return o.addonSkillFeatureIdList=t.array(t.u16(),()=>t.u32(),5),o.skillId=t.u32(),o},200),e.abilityDataList=t.array(t.u16(),()=>x(t,a),100),e}function lt(t,a){t.array(a.statPair,{maxLen:152,lenType:"u16"},e=>{t.u8(e.statType),r(t,e.value)}),t.array(a.statusEffectDatas,{maxLen:80,lenType:"u16"},e=>{s(t,e)}),t.array(a.addonSkillFeatureList,{maxLen:200,lenType:"u16"},e=>{t.array(e.addonSkillFeatureIdList,{maxLen:5,lenType:"u16"},o=>{t.u32(o)}),t.u32(e.skillId)}),t.array(a.abilityDataList,{maxLen:100,lenType:"u16"},e=>{I(t,e)})}var dt="InitLocal";function Nt(t,a){let e={};return e.account_CharacterId1=t.u64(),e.serverAddr=t.string(256),e.account_CharacterId2=t.u64(),e}function St(t,a){t.u64(a.account_CharacterId1),t.string(a.serverAddr,256),t.u64(a.account_CharacterId2)}var bt="MigrationExecute";function L(t,a){let e={};return e.spawnIndex=t.u32(),e.objectId=t.u64(),t.bool()&&(e.transitIndex=t.u32()),e.position=m(t,a),e.statusEffectDatas=t.array(t.u16(),()=>n(t,a),80),e.directionYaw=l(t,a),e.statPair=t.array(t.u16(),()=>{let o={};return o.statType=t.u8(),o.value=i(t,a),o},152),e.typeId=t.u32(),a>=1?(e.level=t.u16(),t.bool()&&(e.balanceLevel=t.u16())):e.level=0,e}function A(t,a){t.u32(a.spawnIndex),t.u64(a.objectId),t.bool(a.transitIndex!==void 0)&&t.u32(a.transitIndex),y(t,a.position),t.array(a.statusEffectDatas,{maxLen:80,lenType:"u16"},e=>{s(t,e)}),d(t,a.directionYaw),t.array(a.statPair,{maxLen:152,lenType:"u16"},e=>{t.u8(e.statType),r(t,e.value)}),t.u32(a.typeId),t.u16(a.level),t.bool(a.balanceLevel!==void 0)&&t.u16(a.balanceLevel)}function gt(t,a){let e={};return e.npcStruct=L(t,a),e}function Et(t,a){A(t,a.npcStruct)}var xt="NewNpc";function It(t,a){let e={};return e.publishReason=t.u8(),e.ownerId=t.u64(),e.npcData=L(t,a),e}function Pt(t,a){t.u8(a.publishReason),t.u64(a.ownerId),A(t,a.npcData)}var vt="NewNpcSummon";function g(t,a){let e={};return e.slot=t.u16(),e.level=t.u16(),e.itemTint=t.bytes(t.u16(),3,14),e.expireTime=N(t),e.id=t.u32(),e}function E(t,a){t.u16(a.slot),t.u16(a.level),t.bytes(a.itemTint,{maxLen:3,lenType:"u16",multiplier:14}),S(t,a.expireTime),t.u32(a.id)}function Vo(t,a){let e={};return e.maxItemLevel=t.f32(),e.statPair=t.array(t.u16(),()=>{let o={};return o.statType=t.u8(),o.value=i(t,a),o},152),e.name=t.string(20),e.heading=l(t,a),e.characterId=t.u64(),e.playerId=t.u64(),e.addonSkillFeatureList=t.array(t.u16(),()=>{let o={};return o.addonSkillFeatureIdList=t.array(t.u16(),()=>t.u32(),5),o.SkillId=t.u32(),o},200),e.classId=t.u16(),e.level=t.u16(),e.statusEffectDatas=t.array(t.u16(),()=>n(t,a),80),a>=1?(e.avgItemLevel=t.f32(),e.position=m(t),e.equipItemDataList=t.array(t.u16(),()=>g(t,a),32),e.equipLifeToolDataList=t.array(t.u16(),()=>g(t,a),9),e.guildName=t.string(20),e.guildId=t.u32()):(e.avgItemLevel=e.maxItemLevel,e.position={x:0,y:0,z:0},e.equipItemDataList=[],e.equipLifeToolDataList=[],e.guildName="",e.guildId=0),e}function Ho(t,a){t.f32(a.maxItemLevel),t.array(a.statPair,{maxLen:152,lenType:"u16"},e=>{t.u8(e.statType),r(t,e.value)}),t.string(a.name,20),d(t,a.heading),t.u64(a.characterId),t.u64(a.playerId),t.array(a.addonSkillFeatureList,{maxLen:200,lenType:"u16"},e=>{t.array(e.addonSkillFeatureIdList,{maxLen:5,lenType:"u16"},o=>{t.u32(o)}),t.u32(e.skillId)}),t.u16(a.classId),t.u16(a.level),t.array(a.statusEffectDatas,{maxLen:80,lenType:"u16"},e=>{s(t,e)}),t.f32(a.avgItemLevel),y(t,a.position),t.array(a.equipItemDataList,{maxLen:32,lenType:"u16"},e=>{E(t,e)}),t.array(a.equipLifeToolDataList,{maxLen:9,lenType:"u16"},e=>{E(t,e)}),t.string(a.guildName,20),t.u32(a.guildId)}function Tt(t,a){let e={};return e.pcStruct=Vo(t,a),e}function Rt(t,a){Ho(t,a.pcStruct)}var kt="NewPC";function Go(t,a){let e={};return e.tripodIndex=Qa(t,a),e.chainSkillEffect=t.u32(),e.skillEffect=t.u32(),e.skillId=t.u32(),e.targetObjectId=t.u64(),e.ownerId=t.u64(),e.skillLevel=t.u8(),e.projectileId=t.u64(),e.tripodLevel=to(t,a),e}function Yo(t,a){Xa(t,a.tripodIndex),t.u32(a.chainSkillEffect),t.u32(a.skillEffect),t.u32(a.skillId),t.u64(a.targetObjectId),t.u64(a.ownerId),t.u8(a.skillLevel),t.u64(a.projectileId),eo(t,a.tripodLevel)}function Lt(t,a){let e={};return e.projectileInfo=Go(t,a),e}function At(t,a){Yo(t,a.projectileInfo)}var ht="NewProjectile";function Ct(t,a){let e={};return e.enable=t.bool(),e.paralyzationPoint=t.u32(),e.decreasePoint=t.u32(),e.paralyzationMaxPoint=t.u32(),e.noHitCheckTime=t.u32(),e.hitCheckTime=t.u32(),e.objectId=t.u64(),e}function Kt(t,a){t.bool(a.enable),t.u32(a.paralyzationPoint),t.u32(a.decreasePoint),t.u32(a.paralyzationMaxPoint),t.u32(a.noHitCheckTime),t.u32(a.hitCheckTime),t.u64(a.objectId)}var Wt="ParalyzationStateNotify";function $o(t,a){let e={};return e.maxHp=i(t,a),e.characterId=t.u64(),e.position=m(t,a),e.transitIndex=t.u32(),e.curHp=i(t,a),e.characterLevel=t.u16(),e.gearLevel=t.f32(),e.zoneId=t.u32(),e.partyMemberNumber=t.u8(),e.name=t.string(20),e.zoneInstId=t.u64(),e.worldId=t.u8(),e.classId=t.u16(),e.auths=t.u8(),e}function Jo(t,a){r(t,a.maxHp),t.u64(a.characterId),y(t,a.position),t.u32(a.transitIndex),r(t,a.curHp),t.u16(a.characterLevel),t.f32(a.gearLevel),t.u32(a.zoneId),t.u8(a.partyMemberNumber),t.string(a.name,20),t.u64(a.zoneInstId),t.u8(a.worldId),t.u16(a.classId),t.u8(a.auths)}function wt(t,a){let e={};return e.raidInstanceId=t.u32(),e.lootGrade=t.u32(),e.partyType=t.u8(),e.partyInstanceId=t.u32(),e.partyLootType=t.u8(),e.memberDatas=t.array(t.u16(),()=>$o(t,a),40),e}function jt(t,a){t.u32(a.raidInstanceId),t.u32(a.lootGrade),t.u8(a.partyType),t.u32(a.partyInstanceId),t.u8(a.partyLootType),t.array(a.memberDatas,{maxLen:40,lenType:"u16"},e=>{Jo(t,e)})}var Mt="PartyInfo";function Bt(t,a){let e={};return e.partyLeaveType=t.u8(),e.partyInstanceId=t.u32(),e.name=t.string(20),e}function Ft(t,a){t.u8(a.partyLeaveType),t.u32(a.partyInstanceId),t.string(a.name,20)}var qt="PartyLeaveResult";function Ot(t,a){let e={};return e.objectId=t.u64(),e.passiveStatusEffectList=t.array(t.u16(),()=>t.u32(),10),e.unk0_m=t.u8(),e}function Zt(t,a){t.u64(a.objectId),t.array(a.passiveStatusEffectList,{maxLen:10,lenType:"u16"},e=>{t.u32(e)}),t.u8(a.unk0_m)}var _t="PartyPassiveStatusEffectAddNotify";function Ut(t,a){let e={};return e.objectId=t.u64(),e.passiveStatusEffectList=t.array(t.u16(),()=>t.u32(),10),e}function zt(t,a){t.u64(a.objectId),t.array(a.passiveStatusEffectList,{maxLen:10,lenType:"u16"},e=>{t.u32(e)})}var Vt="PartyPassiveStatusEffectRemoveNotify";function Ht(t,a){let e={};return e.characterId=t.u64(),e.statusEffectDatas=t.array(t.u16(),()=>n(t,a),80),e.playerIdOnRefresh=t.u64(),e}function Gt(t,a){t.u64(a.characterId),t.array(a.statusEffectDatas,{maxLen:80,lenType:"u16"},e=>{s(t,e)}),t.u64(a.playerIdOnRefresh)}var Yt="PartyStatusEffectAddNotify";function $t(t,a){let e={};return e.characterId=t.u64(),e.statusEffectIds=t.array(t.u16(),()=>t.u32(),80),e.reason=t.u8(),e}function Jt(t,a){t.u64(a.characterId),t.array(a.statusEffectIds,{maxLen:80,lenType:"u16"},e=>{t.u32(e)}),t.u8(a.reason)}var Qt="PartyStatusEffectRemoveNotify";function Xt(t,a){let e={};return e.partyInstanceId=t.u32(),e.raidInstanceId=t.u32(),e.characterId=t.u64(),e}function te(t,a){t.u32(a.partyInstanceId),t.u32(a.raidInstanceId),t.u64(a.characterId)}var ee="PartyStatusEffectResultNotify";function ae(t,a){let e={};return e.passiveStatusEffectList=t.array(t.u16(),()=>t.u32(),10),e}function oe(t,a){t.array(a.passiveStatusEffectList,{maxLen:10,lenType:"u16"},e=>{t.u32(e)})}var ie="PassiveStatusEffectAddNotify";function re(t,a){let e={};return e.passiveStatusEffectList=t.array(t.u16(),()=>t.u32(),10),e}function ne(t,a){t.array(a.passiveStatusEffectList,{maxLen:10,lenType:"u16"},e=>{t.u32(e)})}var se="PassiveStatusEffectRemoveNotify";function fe(t,a){return{}}function ue(t,a){}var me="RaidBossKillNotify";function ye(t,a){return{}}function pe(t,a){}var ce="RaidResult";function Qo(t,a){let e={};return e.unpublishReason=t.u8(),e.objectId=t.u64(),e}function Xo(t,a){t.u8(a.unpublishReason),t.u64(a.objectId)}function le(t,a){let e={};return e.unpublishedObjects=t.array(t.u16(),()=>Qo(t,a),200),e}function de(t,a){t.array(a.unpublishedObjects,{maxLen:200,lenType:"u16"},e=>{Xo(t,e)})}var Ne="RemoveObject";function h(t,a){let e={};return e.modifier=t.u8(),e.targetId=t.u64(),e.damageType=t.u8(),t.bool()&&(e.damageAttr=t.u8()),e.curHp=i(t,a),e.unk3_m=t.u16(),e.maxHp=i(t,a),e.damage=i(t,a),e}function C(t,a){t.u8(a.modifier),t.u64(a.targetId),t.u8(a.damageType),t.bool(a.damageAttr!==void 0)&&t.u8(a.damageAttr),r(t,a.curHp),t.u16(a.unk3_m),r(t,a.maxHp),r(t,a.damage)}function ei(t,a){let e={};return e.skillMoveOptionData=bo(t,a),e.destination=m(t,a),e.position=m(t,a),e.skillDamageEvent=h(t,a),e}function ai(t,a){go(t,a.skillMoveOptionData),y(t,a.destination),y(t,a.position),C(t,a.skillDamageEvent)}function Se(t,a){let e={};return e.skillId=t.u32(),e.skillDamageAbnormalMoveEvents=t.array(t.u16(),()=>ei(t,a),50),e.skillEffectId=t.u32(),e.sourceId=t.u64(),e}function be(t,a){t.u32(a.skillId),t.array(a.skillDamageAbnormalMoveEvents,{maxLen:50,lenType:"u16"},e=>{ai(t,e)}),t.u32(a.skillEffectId),t.u64(a.sourceId)}var ge="SkillDamageAbnormalMoveNotify";function Ee(t,a){let e={};return e.skillLevel=t.u8(),e.sourceId=t.u64(),e.skillId=t.u32(),e.skillDamageEvents=t.array(t.u16(),()=>h(t,a),50),e.skillEffectId=t.u32(),e}function xe(t,a){t.u8(a.skillLevel),t.u64(a.sourceId),t.u32(a.skillId),t.array(a.skillDamageEvents,{maxLen:50,lenType:"u16"},e=>{C(t,e)}),t.u32(a.skillEffectId)}var Ie="SkillDamageNotify";function Pe(t,a){let e={};return e.sourceId=t.u64(),e.skillId=t.u32(),e.stage=t.u8(),e}function ve(t,a){t.u64(a.sourceId),t.u32(a.skillId),t.u8(a.stage)}var De="SkillStageNotify";function Te(t,a){let e={};return e.sourceId=t.u64(),e.curDirectionYaw=l(t,a),e.newDirectionYaw=l(t,a),e.aimTargetPosition=m(t,a),t.bool()&&(e.pitchRotation=l(t,a)),t.bool()&&(e.aiStateId=t.u32()),e.curPosition=m(t,a),t.bool()&&(e.unk1_m=t.u32()),e.skillLevel=t.u8(),e.newPosition=m(t,a),e.skillId=t.u32(),e.skillOptionData=Po(t,a),e}function Re(t,a){t.u64(a.sourceId),d(t,a.curDirectionYaw),d(t,a.newDirectionYaw),y(t,a.aimTargetPosition),t.bool(a.pitchRotation!==void 0)&&d(t,a.pitchRotation),t.bool(a.aiStateId!==void 0)&&t.u32(a.aiStateId),y(t,a.curPosition),t.bool(a.unk1_m!==void 0)&&t.u32(a.unk1_m),t.u8(a.skillLevel),y(t,a.newPosition),t.u32(a.skillId),vo(t,a.skillOptionData)}var ke="SkillStartNotify";function Le(t,a){let e={};return e.statusEffectData=n(t,a),e.objectId=t.u64(),e.new=t.bool(),e}function Ae(t,a){s(t,a.statusEffectData),t.u64(a.objectId),t.bool(a.new)}var he="StatusEffectAddNotify";function Ce(t,a){let e={};return e.statusEffectIds=t.array(t.u16(),()=>t.u32(),80),e.objectId=t.u64(),e.reason=t.u8(),e}function Ke(t,a){t.array(a.statusEffectIds,{maxLen:80,lenType:"u16"},e=>{t.u32(e)}),t.u64(a.objectId),t.u8(a.reason)}var We="StatusEffectRemoveNotify";function we(t,a){let e={};return e.effectInstanceId=t.u32(),e.targetId=t.u64(),e.expirationTick=t.u64(),e}function je(t,a){t.u32(a.effectInstanceId),t.u64(a.targetId),t.u64(a.expirationTick)}var Me="StatusEffectDurationNotify";function Be(t,a){let e={};return e.objectId=t.u64(),e.effectInstanceId=t.u32(),e.characterId=t.u64(),e.value=t.u32(),e}function Fe(t,a){t.u64(a.objectId),t.u32(a.effectInstanceId),t.u64(a.characterId),t.u32(a.value)}var qe="StatusEffectSyncDataNotify";function Oe(t,a){let e={};return e.step=t.u32(),e.unk2_m=t.bool(),e.triggerId=t.u32(),e}function Ze(t,a){t.u32(a.step),t.bool(a.unk2_m),t.u32(a.triggerId)}var _e="TriggerBossBattleStatus";function Ue(t,a){let e={};return e.packetResultCode=t.u32(),e.triggerId=t.u32(),e.unk0_m=t.u32(),e.involvedPCs=t.array(t.u16(),()=>t.u64(),40),e}function ze(t,a){t.u32(a.packetResultCode),t.u32(a.triggerId),t.u32(a.unk0_m),t.array(a.involvedPCs,{maxLen:40,lenType:"u16"},e=>{t.u64(e)})}var Ve="TriggerFinishNotify";function He(t,a){let e={};return e.triggerId=t.u32(),e.triggerSignalType=t.u32(),e.sourceId=t.u64(),e.involvedPCs=t.array(t.u16(),()=>t.u64(),40),e}function Ge(t,a){t.u32(a.triggerId),t.u32(a.triggerSignalType),t.u64(a.sourceId),t.array(a.involvedPCs,{maxLen:40,lenType:"u16"},e=>{t.u64(e)})}var Ye="TriggerStartNotify";function $e(t,a){let e={};return e.maxHp=i(t,a),e.characterId=t.u64(),e.unk0_m=t.u32(),e.statusEffectDatas=t.array(t.u16(),()=>n(t,a),80),e.position=t.u64(),e.curHp=i(t,a),e}function Je(t,a){r(t,a.maxHp),t.u64(a.characterId),t.u32(a.unk0_m),t.array(a.statusEffectDatas,{maxLen:80,lenType:"u16"},e=>{s(t,e)}),t.u64(a.position),r(t,a.curHp)}var Qe="TroopMemberUpdateMinNotify";function Xe(t,a){let e={};return e.identityGauge1=t.u32(),e.identityGauge2=t.u32(),e.identityGauge3=t.u32(),e.playerId=t.u64(),e}function ta(t,a){t.u32(a.identityGauge1),t.u32(a.identityGauge2),t.u32(a.identityGauge3),t.u64(a.playerId)}var ea="IdentityGaugeChangeNotify";function aa(t,a){let e={};return e.objectId=t.u64(),e}function oa(t,a){t.u64(a.objectId)}var ia="ZoneObjectUnpublishNotify";function oi(t,a){let e={};return e.stackCount=t.u8(),e.target=t.u8(),e.id=t.u32(),e}function ii(t,a){t.u8(a.stackCount),t.u8(a.target),t.u32(a.id)}function ra(t,a){let e={};return e.zoneStatusEffectDataList=t.array(t.u16(),()=>oi(t,a),4),e}function na(t,a){t.array(a.zoneStatusEffectDataList,{maxLen:4,lenType:"u16"},e=>{ii(t,e)})}var sa="ZoneStatusEffectAddNotify";function fa(t,a){let e={};return e.statusEffectId=t.u32(),e}function ua(t,a){t.u32(a.statusEffectId)}var ma="ZoneStatusEffectRemoveNotify";function ya(t,a){let e={};return e.skillLevel=t.u8(),e.caster=t.u64(),e.skillId=t.u32(),e}function pa(t,a){t.u8(a.skillLevel),t.u64(a.caster),t.u32(a.skillId)}var ca="SkillCastNotify";function la(t,a){let e={};return e.objectId=t.u64(),e.stance=t.u8(),e}function da(t,a){t.u64(a.objectId),t.u8(a.stance)}var Na="IdentityStanceChangeNotify";function Sa(t,a){let e={};return e.objectId=t.u64(),e.equipItemDataList=t.array(t.u16(),()=>g(t,a),32),e}function ba(t,a){t.u64(a.objectId),t.array(a.equipItemDataList,{maxLen:32,lenType:"u16"},e=>{E(t,e)})}var ga="EquipChangeNotify";function Ea(t,a){let e={};return e.objectId=t.u64(),e.equipLifeToolDataList=t.array(t.u16(),()=>g(t,a),9),e}function xa(t,a){t.u64(a.objectId),t.array(a.equipLifeToolDataList,{maxLen:9,lenType:"u16"},e=>{E(t,e)})}var Ia="EquipLifeToolChangeNotify";function ri(t,a){let e={};return t.bool()&&(e.serialNumber=t.u64(),e.id=t.u32(),e.level=t.u16(),e.slot=t.u16(),e.durability=t.u32(),e.unk1_6_m=t.u32(),e.flag=t.u32(),e.expireTime=N(t),e.lockUpdateTime=N(t)),e}function ni(t,a){t.bool(a.slot!==void 0)&&(t.u64(a.serialNumber),t.u32(a.id),t.u16(a.level),t.u16(a.slot),t.u32(a.durability),t.u32(a.unk1_6_m),t.u32(a.flag),S(t,a.expireTime),S(t,a.lockUpdateTime))}function Pa(t,a){let e={};return e.itemDataList=t.array(t.u16(),()=>ri(t,a),80),e.storageType=t.u8(),e}function va(t,a){t.array(a.storageType===1?a.itemDataList:[],{maxLen:80,lenType:"u16"},e=>{ni(t,e)}),t.u8(a.storageType)}var Da="InitItem";var Ta=new Map([[0,[Z,q,O]],[1,[z,_,U]],[2,[G,V,H]],[4,[J,Y,$]],[5,[tt,Q,X]],[6,[ot,et,at]],[7,[nt,it,rt]],[8,[ut,st,ft]],[9,[pt,mt,yt]],[10,[dt,ct,lt]],[11,[bt,Nt,St]],[12,[xt,gt,Et]],[13,[vt,It,Pt]],[14,[kt,Tt,Rt]],[15,[ht,Lt,At]],[16,[Wt,Ct,Kt]],[17,[Mt,wt,jt]],[18,[qt,Bt,Ft]],[19,[_t,Ot,Zt]],[20,[Vt,Ut,zt]],[21,[Yt,Ht,Gt]],[22,[Qt,$t,Jt]],[23,[ee,Xt,te]],[24,[ie,ae,oe]],[25,[se,re,ne]],[26,[me,fe,ue]],[27,[ce,ye,pe]],[28,[Ne,le,de]],[29,[ge,Se,be]],[30,[Ie,Ee,xe]],[31,[De,Pe,ve]],[32,[ke,Te,Re]],[34,[he,Le,Ae]],[35,[We,Ce,Ke]],[36,[Me,we,je]],[37,[qe,Be,Fe]],[38,[_e,Oe,Ze]],[39,[Ve,Ue,ze]],[40,[Ye,He,Ge]],[41,[Qe,$e,Je]],[42,[ea,Xe,ta]],[43,[ia,aa,oa]],[44,[sa,ra,na]],[45,[ma,fa,ua]],[46,[ca,ya,pa]],[47,[Na,la,da]],[48,[ga,Sa,ba]],[49,[Ia,Ea,xa]],[50,[Da,Pa,va]]]);var D=class{time;#e;#t;#a;#o;constructor(...a){if(a.length===5){let[e,o,f,u,p]=a;this.#t=e,this.time=f,this.#e=o,this.#a=u,this.#o=p}else if(a.length===3){let[e,o,f]=a;this.#t=Buffer.alloc(0),this.time=new Date,this.#e=o,this.#a=()=>e,this.#o=f}else throw new Error("[meter-core/logger/parser] - LogEvent<T>: Invalid constructor arguments")}#i;get parsed(){if(!this.#i)try{this.#i=this.#a(new Ca(this.#t))}catch(a){console.error(`[meter-core/logger/parser] - parsed - ${a}`);return}return this.#i}#r;get serialized(){if(!this.#r)try{if(!this.parsed)return;let a=new Ka;a.skip(ka),this.#o(a,this.parsed);let e=a.value;e.writeUint16LE(e.length,fi),e.writeUint16LE(this.#e,W),e.writeUintLE(+new Date,Ra,w),this.#r=a.value}catch(a){console.error(`[meter-core/logger/parser] - serialized - ${a}`);return}return this.#r}},T=6,si=2,fi=0,K=2,W=fi+si,w=6,Ra=W+K,ka=si+K+w;import{createWriteStream as Ti}from"fs";import{createReadStream as Ri}from"fs";var j=class extends Di{},ui=class extends j{#e;#t;constructor(a,e,o){super(),this.#e=e,o&&(this.#t=Ti(o,{highWaterMark:0}));let f=Buffer.allocUnsafe(T);f.writeUIntLE(1,0,T),this.#t?.write(f),a.on("*",this.handlePkt.bind(this))}handlePkt(a,e,o,f){try{let u=Bo.get(e),p=qo.get(e);if(u&&p){let[c]=p,[La,M]=u,v=Ta.get(c);if(v){let[R,ki,pi]=v,Aa=new Fo(Buffer.from(a),e,o,!!f,this.#e,M).parsed;if(!Aa)return;let B=new D(Aa,c,pi);this.emit(R,B),this.emit("*",R,B),this.appendLog(B)}}}catch(u){console.error(u)}}appendLog(a){this.#t&&a.serialized&&this.#t.write(a.serialized)}},mi=class extends j{readLogByChunk(a){let e=new ha,o=Ri(a),f=!1,u;o.on("data",p=>{if(u===void 0){if(u=this.readVersion(p),u>1){o.destroy();return}p=p.subarray(T)}e.write(p);let c;for(;c=e.read();)this.readLogChunk(c,u)}).on("end",()=>{f=!0,this.emit("fileEnd","end")}).on("close",()=>{f||this.emit("fileEnd","closed")})}readLogChunk(a,e){try{if(a.length<8)return!1;let o=a.readUIntLE(W,K),f=new Date(a.readUintLE(Ra,w)),u=a.subarray(ka),p=Ta.get(o);if(p){let[c,La,M]=p,v=new D(u,o,new Date(f),R=>La(R,e),M);this.emit(c,v),this.emit("*",c,v)}}catch(o){console.error(o)}}readVersion(a){return a.readUintLE(0,T)}};export{ui as LiveLogger,j as Logger,mi as ReplayLogger};
