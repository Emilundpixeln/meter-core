import{uncompressSync as t}from"lz4-napi";import c from"oodle";import{uncompress as a}from"snappyjs";var l=class{oodle;xorTable;logErrorFunc;constructor(r,o,e){if(this.oodle=new c.Oodle(r),o.length!=256)throw new Error("Invalid xorTable length");this.xorTable=o,this.logErrorFunc=e}decrypt(r,o,e,s){s&&this.xor(r,o);let n;switch(e){case 0:{n=r;break}case 1:{n=t(r);break}case 2:{n=a(r);break}case 3:{if(r.length<4)throw new Error(`Invalid oodle packet: size=${r.length}, comp=${e}, opcode=${o}`);n=this.oodle.decode(r.subarray(4),r.readUInt32LE(0));break}default:throw new Error(`Unknown compression: ${e}`)}if(n.length<16)throw new Error(`Invalid packet: size=${n.length}, comp=${e}, opcode=${o}`);return n.subarray(16)}xor(r,o){for(let e=0;e<r.length;e++)r[e]^=this.xorTable[o++%256]}};export{l as Decompressor};
