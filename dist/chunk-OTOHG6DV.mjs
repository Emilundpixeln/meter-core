import{TypedEmitter as Qo}from"tiny-typed-emitter";var n=class{b;o;constructor(t){this.b=t,this.o=0}skip(t=0){this.o+=t}bool(){return this.u8()===1}u8(){return this.b.readUint8(this.o++)}i8(){return this.b.readInt8(this.o++)}u16(){let t=this.b.readUint16LE(this.o);return this.o+=2,t}i16(){let t=this.b.readInt16LE(this.o);return this.o+=2,t}u32(){let t=this.b.readUint32LE(this.o);return this.o+=4,t}i32(){let t=this.b.readInt32LE(this.o);return this.o+=4,t}f32(){let t=this.b.readFloatLE(this.o);return this.o+=4,t}u64(){let t=this.b.readBigUint64LE(this.o);return this.o+=8,t}i64(){let t=this.b.readBigInt64LE(this.o);return this.o+=8,t}string(t){let o=this.u16();if(o<=t){o=o*2;let r=this.b.toString("utf16le",this.o,this.o+o);return this.o+=o,r}return""}bytes(t=0,o,r){if(o&&t>o)return Buffer.alloc(0);r&&(t=t*r);let i=Buffer.from(this.b.subarray(this.o,this.o+t));return this.o+=t,i}array(t,o,r){return r&&t>r?[]:new Array(t).fill(void 0).map(o)}},fo=class{b;o;constructor(t=65535){this.b=Buffer.allocUnsafe(t),this.o=0}get value(){return this.b.subarray(0,this.o)}skip(t=0){this.o+=t}bool(t=!1){return this.u8(t?1:0),t}u8(t=0){this.b.writeUInt8(t,this.o++)}i8(t=0){this.b.writeInt8(t,this.o++)}u16(t=0){this.o=this.b.writeUInt16LE(t,this.o)}i16(t=0){this.o=this.b.writeInt16LE(t,this.o)}u32(t=0){this.o=this.b.writeUInt32LE(t,this.o)}i32(t=0){this.o=this.b.writeInt32LE(t,this.o)}f32(t=0){this.o=this.b.writeFloatLE(t,this.o)}u64(t=0n){this.o=this.b.writeBigUInt64LE(BigInt(t),this.o)}i64(t=0n){this.o=this.b.writeBigInt64LE(BigInt(t),this.o)}string(t="",o=0){this.u16(t.length),t.length<=o&&(this.o+=this.b.write(t,this.o,"utf16le"))}bytes(t=Buffer.alloc(0),o={}){if(o.maxLen){let r=o.multiplier??1;if(t.length%r)throw new Error(`Error writing bytes, chunkSize should be a multiple of intut value size, got ${t.length}%${r}`);let i=t.length/r;if(i>o.maxLen)throw new Error(`Error writing bytes, input value size exceeded maxLen, got ${i} > ${o.maxLen}`);if(!o.lenType)throw new Error(`Error writing bytes, invalid lenType when writing chunks, got ${o.lenType}`);this[o.lenType](i)}else if(o.length&&t.length!==o.length)throw new Error(`Error writing bytes, input value size doesn't match opts.length, ${t.length} !== ${o.lenType}`);this.o+=t.copy(this.b,this.o)}array(t=[],o,r){if(t===void 0||t.length>o.maxLen){this[o.lenType](0);return}this[o.lenType](t.length),t.forEach(r)}};function l(e){let t={};return t.Points=e.u16(),t.Id=e.u32(),t.Level=e.u8(),t}function E(e){let t=new n(e),o={};return o.abilityDataList=t.array(t.u16(),()=>l(t),100),o}var v="PKTAbilityChangeNotify",h=37279;function mo(e){let t={};return t.FeatureType=e.u16(),t.Level=e.u32(),t}function R(e){let t=new n(e),o={};return o.activeAbilityList=t.array(t.u16(),()=>mo(t),60),o.ObjectId=t.u64(),o}var D="PKTActiveAbilityNotify",_=43908;function A(e){let t=new n(e),o={};return o.ObjectId=t.u64(),o.struct_117=t.bytes(t.u16(),200,4),o.addonSkillFeatureList=t.array(t.u16(),()=>{let r={};return r.addonSkillFeatureIdList=t.array(t.u16(),()=>t.u32(),5),r.SkillId=t.u32(),r},200),o}var B="PKTAddonSkillFeatureChangeNotify",L=36297;function C(e){let t=new n(e),o={};return o.PacketResultCode=t.u32(),o.Unk1_m=t.bytes(t.u32(),688),o}var w="PKTAuthTokenResult",M=36363;function O(e){let t=new n(e),o={};return t.skip(1),o.ParalyzationMaxPoint=t.u32(),o.Type=t.u8(),o.ObjectId=t.u64(),t.skip(1),o.ParalyzationPoint=t.u32(),o}var F="PKTBlockSkillStateNotify",j=33660;function V(e){let t=new n(e),o={};return t.skip(1),o.SourceId=t.u64(),o.Type=t.u32(),o.TargetId=t.u64(),o}var Z="PKTCounterAttackNotify",z=44612;function H(e){let t=new n(e),o={};return o.SourceId=t.u64(),t.bool()&&(o.Unk1_0=t.u8()),t.bool()&&(o.Unk2_0=t.u8()),o.Unk3=t.u32(),o.Unk4=t.u32(),o.Unk5=t.u8(),t.bool()&&(o.Unk6_0=t.u8()),o.TargetId=t.u64(),o.Unk8=t.u16(),o.Unk9=t.u64(),o}var G="PKTDeathNotify",W=27220;function Y(e){let t=new n(e),o={};return o.struct_121=t.bytes(t.u16(),348,48),o.abilityDataList=t.array(t.u16(),()=>l(t),100),o}var $="PKTInitAbility",q=48153;var Bo=[0,31,28,31,30,31,30,31,31,30,31,30,31];function Lo(e){return!(e%4||!(e%100)&&e%400)}function Co(e,t,o){if(e>99){if(e<1752||e==1752&&(t<9||t==9&&o<<14))return!1}else e+=1900;return o>0&&t<=12&&(o<=Bo[t]||o==29&&t==2&&Lo(e))}function J(e){let t=Number(e&0xffffffffn),o=Number(e>>32n&0xffffffffn),r=t&4095,i=(t&65535)>>12,u=t>>16&31;Co(r,i,u)||(r=i=u=0);let m=t>>21&31,P=t>>26&63,k=o&63,N=o>>6&16383;return m<24&&P<60&&k<60&&N<1e3||(m=24,P=k=N=0),new Date(Date.UTC(r<=99?r+1900:r,i-1,u,m,P,k,N))}function co(e){let t=0n;return t|=BigInt(e.getUTCMilliseconds())<<38n,t|=BigInt(e.getUTCSeconds())<<32n,t|=BigInt(e.getUTCMinutes())<<26n,t|=BigInt(e.getUTCHours())<<21n,t|=BigInt(e.getUTCDate())<<16n,t|=BigInt(e.getUTCMonth()+1)<<12n,t|=BigInt(e.getUTCFullYear()<2e3?e.getUTCFullYear()-1900:e.getUTCFullYear()),t}function y(e,t=0){let o=e.u16();return(o&4095)<2079?(e.o-=2,J(e.i64())):J(BigInt(o)&0xfffn|0x11000n)}function Pn(e,t=J(0x1181fn)){t.getUTCFullYear()>=2079?e.u16(Number(co(t)&0xffffn)):e.i64(co(t))}function X(e){let t=new n(e),o={};return o.Unk0=t.u8(),o.Unk1=t.u32(),o.Unk2=t.u32(),o.PlayerId=t.u64(),o.lostArkDateTime=y(t),o.struct_542=t.string(128),o.Unk6=t.u64(),o.struct_25=t.array(t.u16(),()=>{let r={};return r.struct_529=t.string(32),r.versionString=t.string(64),r.struct_542=t.string(128),r},64),o}var tt="PKTInitEnv",et=22330;function wo(e){if(e.length===0)return 0n;if(e.length>8)throw new Error("Value is too large");let t=Buffer.alloc(8);return e.copy(t),t.readBigInt64LE()}function a(e,t=0){let o=e.u8(),r=e.bytes(o>>1&7),i=wo(r)<<4n|BigInt(o>>4);return o&1?-i:i}function Sn(e,t=0n){let o=Buffer.alloc(8),r=t<0n;o.writeBigInt64LE((r?-t:t)>>4n);let i=0;for(let[u,m]of o.entries())m!=0&&(i=u+1);if(i>7)throw new Error("Value is too large");e.u8(Number((r?-t:t)&0xfn)<<4|(i&7)<<1|(r?1:0)),e.bytes(o.subarray(0,i),{length:i})}function s(e){let t={};return t.SkillLevel=e.u8(),t.OccurTime=y(e),t.StatusEffectId=e.u32(),t.SourceId=e.u64(),e.bool()&&(t.Unk4_0=e.u64()),t.TotalTime=e.u32(),t.EndTick=e.u64(),t.struct_420=e.bytes(e.u16(),8,7),e.bool()&&(t.Value=e.bytes(16)),t.EffectInstanceId=e.u32(),t.Unk10=e.u8(),t}function b(e){let t={};return t.Unk0=a(e),t.Unk1=a(e),t.Unk2=e.u8(),t.Unk3=e.u8(),t.Unk4=e.u8(),t.Unk5=e.u64(),t.Unk6=e.u16(),t}function nt(e){let t=new n(e),o={};return o.Unk0=t.u16(),o.Unk1=t.u8(),o.struct_314=t.bytes(t.u16(),104,30),o.Unk3=t.u8(),o.Unk4=t.u8(),o.Unk5=t.u16(),o.statPair=t.array(t.u16(),()=>{let r={};return r.StatType=t.u8(),r.Value=a(t),r},152),o.Unk7=t.u8(),o.Unk8=t.u8(),o.Unk9=t.bytes(116),o.Unk10=t.u32(),o.Unk11=t.u32(),o.Unk12=t.u8(),o.Unk13=t.u8(),o.Unk14=t.u64(),o.Unk15=t.u32(),o.Unk16=t.u32(),o.Unk17=t.u8(),o.Unk18=t.u32(),o.struct_91=t.bytes(t.u16(),57),o.Name=t.string(20),o.Unk21=t.u32(),o.Unk22=t.u8(),o.Unk23=t.bytes(35),o.Unk24=t.u8(),o.Unk25=t.u8(),o.Unk26=t.u8(),o.Unk27=t.u32(),o.Unk28=t.u32(),o.Unk29=t.u8(),t.bool()&&(o.Unk30_0=t.u32()),o.Unk31=t.u64(),o.Unk32=t.u8(),o.struct_338=t.string(7),o.Unk34=t.u8(),o.Unk35=t.u16(),o.Unk36=t.u8(),o.Level=t.u16(),o.Unk38=t.u16(),o.Unk39=t.u32(),o.Unk40=t.u64(),o.Unk41=t.u8(),o.Unk42=t.u32(),o.statusEffectDatas=t.array(t.u16(),()=>s(t),80),o.Unk44=t.u8(),o.Unk45=t.bytes(25),o.CharacterId=t.u64(),o.GearLevel=t.u32(),o.Unk48=t.u8(),o.Unk49=t.u64(),o.struct_211=t.bytes(t.u16(),3,17),o.Unk51=t.u32(),o.PlayerId=t.u64(),o.Unk53=t.u32(),o.Unk54=t.u8(),o.struct_363=t.array(t.u16(),()=>b(t),5),o.ClassId=t.u16(),o}var rt="PKTInitPC",at=52266;function po(e){let t={};return e.bool()&&(t.Unk0_0=e.u32()),t.Unk1=e.u32(),e.bool()&&(t.Unk2_0=e.bytes(9)),t.Unk3=e.u32(),t.Unk4=e.u32(),t}function it(e){let t=new n(e),o={};return o.struct_314=t.bytes(t.u16(),104,30),o.Unk1=t.u32(),t.bool()&&(o.Unk2_0=t.u32()),o.struct_117=t.bytes(t.u16(),200,4),o.struct_396=t.array(t.u16(),()=>po(t),300),o.Unk5=t.u8(),o.Unk6=t.u64(),o.struct_211=t.bytes(t.u16(),3,17),o.statPair=t.array(t.u16(),()=>{let r={};return r.StatType=t.u8(),r.Value=a(t),r},152),o.Unk9=t.u8(),o.Unk10=t.u64(),o.Unk11=t.u8(),o.statusEffectDatas=t.array(t.u16(),()=>s(t),80),o.addonSkillFeatureList=t.array(t.u16(),()=>{let r={};return r.addonSkillFeatureIdList=t.array(t.u16(),()=>t.u32(),5),r.SkillId=t.u32(),r},200),o.struct_121=t.bytes(t.u16(),348,48),o.abilityDataList=t.array(t.u16(),()=>l(t),100),o}var st="PKTInitLocal",ut=18980;function ft(e){let t=new n(e),o={};return o.Account_CharacterId1=t.u64(),o.ServerAddr=t.string(256),o.Account_CharacterId2=t.u64(),o.Unk3=t.u32(),o}var mt="PKTMigrationExecute",ct=19365;function T(e){let t={};return t.Unk0=e.u16(),t.lostArkDateTime=y(e),t.Unk2=e.u16(),t.Unk3=e.u32(),t.struct_426=e.bytes(e.u16(),3,14),e.bool()&&(t.Unk5_0=e.u8()),t}function yo(e){let t={};return t.Unk0=e.u8(),t.Unk1=e.u8(),t.Unk2=e.u16(),t.lostArkString=e.string(20),t.Unk4=e.u64(),t.struct_84=e.bytes(e.u32(),512),t.Unk6=e.u8(),t.struct_293=e.array(e.u16(),()=>T(e),32),t}function pt(e){return e>>20===1?-((~e>>>0)+1&2097151):e}function f(e,t=0){let o=e.u64();return{x:pt(Number(o&0x1fffffn)),y:pt(Number(o>>21n&0x1fffffn)),z:pt(Number(o>>42n&0x1fffffn))}}function En(e,t={x:0,y:0,z:0}){e.u64(BigInt(Math.round(t.x??0)>>>0&2097151)|BigInt(Math.round(t.y??0)>>>0&2097151)<<21n|BigInt(Math.round(t.z??0)>>>0&2097151)<<42n)}function p(e,t=0){return e.u16()*(2*Math.PI)/65536}function vn(e,t=0){e.u16(Math.round(t*65536/(2*Math.PI))%65536)}function x(e){let t={};return t.Unk0=e.u16(),e.bool()&&(t.Unk1_0=e.u8()),t.Unk2=e.u8(),t.SpawnIndex=e.i32(),e.bool()&&(t.struct_247=e.bytes(e.u16(),12,12)),t.ObjectId=e.u64(),t.Unk6=e.u8(),e.bool()&&(t.Unk7_0=e.u8()),e.bool()&&(t.TransitIndex=e.u32()),e.bool()&&(t.Unk9_0=e.u8()),t.Unk10=e.u8(),t.Unk11=e.u8(),t.Position=f(e),t.struct_363=e.array(e.u16(),()=>b(e),5),e.bool()&&(t.Unk14_0=e.u16()),e.bool()&&(t.Unk15_0=e.u16()),e.bool()&&(t.Unk16_0=e.u64()),t.Unk17=e.u8(),t.statusEffectDatas=e.array(e.u16(),()=>s(e),80),e.bool()&&(t.Unk19_0=e.u32()),e.bool()&&(t.Unk20_0=e.u32()),t.Unk21=e.u8(),e.bool()&&(t.Unk22_0=e.u32()),e.bool()&&(t.Unk23_0=e.u32()),t.DirectionYaw=p(e),e.bool()&&(t.struct_673=yo(e)),e.bool()&&(t.Unk26_0=e.u8()),t.statPair=e.array(e.u16(),()=>{let o={};return o.StatType=e.u8(),o.Value=a(e),o},152),e.bool()&&(t.struct_310=e.bytes(e.u16(),11,9)),e.bool()&&(t.Unk29_0=e.u8()),t.TypeId=e.u32(),e.bool()&&(t.Unk31_0=e.u8()),e.bool()&&(t.Unk32_0=e.u8()),t}function lt(e){let t=new n(e),o={};return o.NpcStruct=x(t),o.Unk1=t.u8(),t.bool()&&(o.Unk0_0=t.string(20),o.Unk0_1=t.string(20)),t.bool()&&(o.Unk3_0=t.u64()),t.bool()&&(o.Unk4_0=t.u8()),o}var yt="PKTNewNpc",bt=1040;function Pt(e){let t=new n(e),o={};return o.PublishReason=t.u8(),t.skip(18),o.OwnerId=t.u64(),t.skip(13),o.NpcData=x(t),o}var kt="PKTNewNpcSummon",Tt=3448;function Po(e){let t={};return t.Unk0=e.u16(),t.Unk1=e.u8(),t.GearLevel=e.u32(),t.statPair=e.array(e.u16(),()=>{let o={};return o.StatType=e.u8(),o.Value=a(e),o},152),t.Unk4=e.u32(),t.Unk5=e.u64(),t.Name=e.string(20),t.Unk7=e.bytes(5),t.Heading=p(e),t.Unk9=e.u8(),t.Unk10=e.u8(),t.CharacterId=e.u64(),t.Unk12=e.u32(),t.Unk13=e.u8(),t.Unk14=e.u8(),t.Unk15=e.string(20),t.struct_363=e.array(e.u16(),()=>b(e),5),t.Unk5_m=e.u32(),t.Unk18=e.u32(),t.Unk19=e.u8(),t.PlayerId=e.u64(),t.struct_293=e.array(e.u16(),()=>T(e),32),t.addonSkillFeatureList=e.array(e.u16(),()=>{let o={};return o.addonSkillFeatureIdList=e.array(e.u16(),()=>e.u32(),5),o.SkillId=e.u32(),o},200),t.Unk23=e.bytes(25),t.Unk24=e.u8(),t.Unk25=e.u32(),t.Unk26=e.u8(),t.ClassId=e.u16(),t.Unk28=e.u8(),t.Unk29=e.u32(),t.Unk30=e.u32(),t.Unk31=e.u8(),t.struct_292=e.array(e.u16(),()=>T(e),9),t.Level=e.u16(),t.Unk34=e.u16(),t.Unk35=e.u8(),t.struct_117=e.bytes(e.u16(),200,4),t.statusEffectDatas=e.array(e.u16(),()=>s(e),80),t.Unk38=e.u32(),t.Unk39=e.u32(),t.Unk40=e.u32(),t.struct_84=e.bytes(e.u32(),512),e.bool()&&(t.Unk42_0=e.bytes(12)),t.Unk43=e.u8(),t.Unk44=e.u16(),t}function ko(e){let t={};return t.Unk0=e.u32(),t.Unk1=e.u32(),e.bool()&&(t.Unk2_0=e.bytes(12)),t.Unk3=e.bytes(12),t}function St(e){let t=new n(e),o={};return t.bool()&&(o.Unk3_0_m=t.u32()),o.PCStruct=Po(t),o.Unk0_m=t.u8(),t.bool()&&(o.TrackMoveInfo=ko(t)),o.Unk2_m=t.u8(),t.bool()&&(o.Unk4_0_m=t.bytes(12)),t.bool()&&(o.Unk5_0_m=t.bytes(20)),o}var xt="PKTNewPC",Ut=15971;function U(e,t=0){return{first:e.u8(),second:e.u8(),third:e.u8()}}function To(e,t){e.u8(t.first),e.u8(t.second),e.u8(t.third)}function g(e,t=0){return{first:e.u16(),second:e.u16(),third:e.u16()}}function xo(e,t){e.u16(t.first),e.u16(t.second),e.u16(t.third)}function go(e){let t={};return t.Unk0=e.u32(),t.tripodIndex=U(e),t.ChainSkillEffect=e.u32(),e.bool()&&(t.struct_310=e.bytes(e.u16(),11,9)),t.Unk4=e.u8(),e.bool()&&(t.Unk5_0=e.u64()),t.Unk6=e.u16(),t.Unk7=e.u64(),t.Unk8=e.u8(),t.SkillEffect=e.u32(),t.Unk10=e.u64(),t.Unk11=e.u32(),t.SkillId=e.u32(),t.TargetObjectId=e.u64(),t.Unk14=e.u16(),t.OwnerId=e.u64(),t.SkillLevel=e.u8(),e.bool()&&(t.Unk17_0=e.u32()),t.Unk18=e.u32(),t.ProjectileId=e.u64(),t.tripodLevel=g(e),t}function gt(e){let t=new n(e),o={};return o.projectileInfo=go(t),o}var Kt="PKTNewProjectile",Nt=6340;function It(e){let t=new n(e),o={};return o.Enable=t.bool(),o.ParalyzationPoint=t.u32(),o.DecreasePoint=t.u32(),t.skip(1),o.ParalyzationMaxPoint=t.u32(),o.NoHitCheckTime=t.u32(),o.HitCheckTime=t.u32(),o.ObjectId=t.u64(),t.skip(1),o}var Et="PKTParalyzationStateNotify",vt=47778;function Ko(e){let t={};return t.MaxHp=a(e),t.Unk1=e.u8(),t.CharacterId=e.u64(),t.Position=f(e),t.TransitIndex=e.u32(),t.CurHp=a(e),t.Unk6=e.u8(),t.CharacterLevel=e.u16(),t.GearLevel=e.u32(),t.ZoneId=e.u32(),t.Unk10=e.u8(),t.Unk11=e.u8(),t.PartyMemberNumber=e.u8(),t.Name=e.string(20),t.Unk14=e.u16(),t.ZoneInstId=e.u64(),t.WorldId=e.u8(),t.ClassId=e.u16(),t.Unk18=e.u8(),t.Auths=e.u8(),t}function ht(e){let t=new n(e),o={};return o.RaidInstanceId=t.u32(),o.LootGrade=t.u32(),o.PartyType=t.u8(),o.PartyInstanceId=t.u32(),o.PartyLootType=t.u8(),o.MemberDatas=t.array(t.u16(),()=>Ko(t),40),o}var Rt="PKTPartyInfo",Dt=54811;function _t(e){let t=new n(e),o={};return o.PartyLeaveType=t.u8(),o.PartyInstanceId=t.u32(),o.Name=t.string(20),o}var At="PKTPartyLeaveResult",Bt=43243;function Lt(e){let t=new n(e),o={};return o.ObjectId=t.u64(),o.passiveStatusEffectList=t.array(t.u16(),()=>t.u32(),10),o.Unk0_m=t.u8(),o}var Ct="PKTPartyPassiveStatusEffectAddNotify",wt=19025;function Mt(e){let t=new n(e),o={};return o.ObjectId=t.u64(),o.passiveStatusEffectList=t.array(t.u16(),()=>t.u32(),10),o}var Ot="PKTPartyPassiveStatusEffectRemoveNotify",Ft=40394;function jt(e){let t=new n(e),o={};return o.Unk0=t.u64(),o.CharacterId=t.u64(),o.statusEffectDatas=t.array(t.u16(),()=>s(t),80),o.Unk3=t.u8(),o.PlayerIdOnRefresh=t.u64(),o}var Vt="PKTPartyStatusEffectAddNotify",Zt=12206;function zt(e){let t=new n(e),o={};return o.CharacterId=t.u64(),o.Unk1=t.u64(),o.statusEffectIds=t.array(t.u16(),()=>t.u32(),80),o.Reason=t.u8(),o}var Ht="PKTPartyStatusEffectRemoveNotify",Gt=38092;function Wt(e){let t=new n(e),o={};return t.skip(1),o.PartyInstanceId=t.u32(),t.skip(13),o.RaidInstanceId=t.u32(),t.skip(12),o.CharacterId=t.u64(),o}var Yt="PKTPartyStatusEffectResultNotify",$t=35973;function qt(e){let t=new n(e),o={};return o.passiveStatusEffectList=t.array(t.u16(),()=>t.u32(),10),o}var Jt="PKTPassiveStatusEffectAddNotify",Qt=12394;function Xt(e){let t=new n(e),o={};return o.passiveStatusEffectList=t.array(t.u16(),()=>t.u32(),10),o}var te="PKTPassiveStatusEffectRemoveNotify",ee=2763;function oe(e){let t=new n(e),o={};return o.Unk0=t.bytes(5),o}var ne="PKTRaidBossKillNotify",re=1876;function ae(e){let t=new n(e),o={};return o.Unk0=t.u64(),o.Unk1=t.u64(),o.struct_44=t.array(t.u16(),()=>{let r={};return r.Unk0_0_0=a(t),r.Unk0_0_1=t.u32(),r.struct_494=t.bytes(t.u16(),3),r.Unk0_0_3=a(t),r},3),o.Unk3=t.u8(),o.Unk4=t.u8(),o.Unk5=t.u64(),o.Unk6=t.u8(),o.Unk7=t.u64(),o}var ie="PKTRaidResult",se=10861;function No(e){let t={};return t.UnpublishReason=e.u8(),t.ObjectId=e.u64(),t}function ue(e){let t=new n(e),o={};return o.unpublishedObjects=t.array(t.u16(),()=>No(t),200),o}var fe="PKTRemoveObject",me=25018;function Io(e,t=0){let o={},r=e.u8();return r&1&&(o.MoveTime=e.u32()),r&2&&(o.StandUpTime=e.u32()),r&4&&(o.DownTime=e.u32()),r&8&&(o.FreezeTime=e.u32()),r&16&&(o.MoveHeight=e.u32()),r&32&&(o.FarmostDist=e.u32()),r&64&&(o.flag40=e.bytes(e.u16(),6)),o}function fr(e,t){let o=(t.MoveTime===void 0?0:1)|(t.StandUpTime===void 0?0:2)|(t.DownTime===void 0?0:4)|(t.FreezeTime===void 0?0:8)|(t.MoveHeight===void 0?0:16)|(t.FarmostDist===void 0?0:32)|(t.flag40===void 0?0:64);e.u8(o),o&1&&e.u32(t.MoveTime),o&2&&e.u32(t.StandUpTime),o&4&&e.u32(t.DownTime),o&8&&e.u32(t.FreezeTime),o&16&&e.u32(t.MoveHeight),o&32&&e.u32(t.FarmostDist),o&64&&e.bytes(t.flag40,{maxLen:6,lenType:"u16"})}function K(e){let t={};return t.Modifier=e.u8(),t.TargetId=e.u64(),t.DamageType=e.u8(),e.bool()&&(t.DamageAttr=e.u8()),t.CurHp=a(e),t.Unk3_m=e.i16(),t.MaxHp=a(e),t.Damage=a(e),t}function vo(e){let t={};return t.Unk1_m=e.u8(),t.Unk2_m=e.u64(),t.Unk4_m=e.u16(),t.SkillMoveOptionData=Io(e),t.Destination=f(e),t.Position=f(e),t.Unk8_m=e.u16(),t.skillDamageEvent=K(e),t.Unk3_m=e.u16(),t}function ce(e){let t=new n(e),o={};return o.SkillId=t.u32(),o.Unk2_m=t.u32(),o.Unk1_m=t.u8(),o.SkillDamageAbnormalMoveEvents=t.array(t.u16(),()=>vo(t),50),o.SkillEffectId=t.u32(),o.SourceId=t.u64(),o}var pe="PKTSkillDamageAbnormalMoveNotify",de=44143;function le(e){let t=new n(e),o={};return o.SkillLevel=t.u8(),o.SourceId=t.u64(),o.SkillId=t.u32(),o.SkillDamageEvents=t.array(t.u16(),()=>K(t),50),o.SkillEffectId=t.u32(),o}var ye="PKTSkillDamageNotify",be=50947;function Pe(e){let t=new n(e),o={};return t.skip(28),o.SourceId=t.u64(),o.SkillId=t.u32(),t.skip(13),o.Stage=t.u8(),o}var ke="PKTSkillStageNotify",Te=44221;function ho(e,t=0){let o={},r=e.u8();return r&1&&(o.LayerIndex=e.u8()),r&2&&(o.StartStageIndex=e.u8()),r&4&&(o.TransitIndex=e.u32()),r&8&&(o.StageStartTime=e.u32()),r&16&&(o.FarmostDistance=e.u32()),r&32&&(o.TripodIndex=U(e)),r&64&&(o.TripodLevel=g(e)),o}function br(e,t){let o=(t.LayerIndex===void 0?0:1)|(t.StartStageIndex===void 0?0:2)|(t.TransitIndex===void 0?0:4)|(t.StageStartTime===void 0?0:8)|(t.FarmostDistance===void 0?0:16)|(t.TripodIndex===void 0?0:32)|(t.TripodLevel===void 0?0:64);e.u8(o),o&1&&e.u8(t.LayerIndex),o&2&&e.u8(t.StartStageIndex),o&4&&e.u32(t.TransitIndex),o&8&&e.u32(t.StageStartTime),o&16&&e.u32(t.FarmostDistance),o&32&&To(e,t.TripodIndex),o&64&&xo(e,t.TripodLevel)}function Se(e){let t=new n(e),o={};return o.SourceId=t.u64(),o.CurDirectionYaw=p(t),o.NewDirectionYaw=p(t),o.AimTargetPosition=f(t),t.bool()&&(o.PitchRotation=p(t)),t.bool()&&(o.AiStateId=t.u32()),o.CurPosition=f(t),t.bool()&&(o.Unk1_m=t.i32()),o.SkillLevel=t.u8(),o.NewPosition=f(t),o.SkillId=t.u32(),o.SkillOptionData=ho(t),o}var xe="PKTSkillStartNotify",Ue=16905;function ge(e){let t=new n(e),o={};return o.Unk0=t.array(t.u16(),()=>{let r={};return r.StatType=t.u8(),r.Value=a(t),r},152),o.Unk1=t.array(t.u16(),()=>{let r={};return r.StatType=t.u8(),r.Value=a(t),r},152),t.bool()&&(o.Unk2_0=t.u32()),o.Unk3=t.u8(),o.ObjectId=t.u64(),o}var Ke="PKTStatChangeOriginNotify",Ne=6051;function Ie(e){let t=new n(e),o={};return o.statusEffectData=s(t),o.ObjectId=t.u64(),o.New=t.bool(),o.Unk3=t.u64(),t.bool()&&(o.Unk4_0=t.u64()),o}var Ee="PKTStatusEffectAddNotify",ve=56830;function he(e){let t=new n(e),o={};return o.statusEffectIds=t.array(t.u16(),()=>t.u32(),80),o.ObjectId=t.u64(),o.Reason=t.u8(),o}var Re="PKTStatusEffectRemoveNotify",De=23914;function _e(e){let t=new n(e),o={};return t.skip(1),o.EffectInstanceId=t.u32(),o.TargetId=t.u64(),o.ExpirationTick=t.u64(),o}var Ae="PKTStatusEffectDurationNotify",Be=46140;function Le(e){let t=new n(e),o={};return o.ObjectId=t.u64(),t.skip(1),o.EffectInstanceId=t.u32(),o.CharacterId=t.u64(),o.Value=t.u32(),t.skip(5),o}var Ce="PKTStatusEffectSyncDataNotify",we=2750;function Me(e){let t=new n(e),o={};return t.skip(2),o.Step=t.u32(),t.skip(1),o.Unk2_m=t.bool(),o.TriggerId=t.u32(),o}var Oe="PKTTriggerBossBattleStatus",Fe=9915;function je(e){let t=new n(e),o={};return o.PacketResultCode=t.u32(),o.TriggerId=t.u32(),o.Unk0_m=t.u32(),o.InvolvedPCs=t.array(t.u16(),()=>t.u64(),40),o}var Ve="PKTTriggerFinishNotify",Ze=53812;function ze(e){let t=new n(e),o={};return o.TriggerId=t.u32(),o.TriggerSignalType=t.u32(),o.SourceId=t.u64(),o.InvolvedPCs=t.array(t.u16(),()=>t.u64(),40),o}var He="PKTTriggerStartNotify",Ge=49092;function We(e){let t=new n(e),o={};return o.MaxHp=a(t),o.CharacterId=t.u64(),o.Unk0_m=t.u32(),o.statusEffectDatas=t.array(t.u16(),()=>s(t),80),o.Position=t.u64(),o.CurHp=a(t),o}var Ye="PKTTroopMemberUpdateMinNotify",$e=7345;function qe(e){let t=new n(e),o={};return t.skip(1),o.IdentityGauge1=t.i32(),o.IdentityGauge2=t.i32(),o.IdentityGauge3=t.i32(),t.skip(1),o.PlayerId=t.u64(),o}var Je="PKTIdentityGaugeChangeNotify",Qe=11255;function Xe(e){let t=new n(e),o={};return o.ObjectId=t.u64(),t.skip(2),o}var to="PKTZoneObjectUnpublishNotify",eo=53893;function Ro(e){let t={};return t.StackCount=e.u8(),t.Target=e.u8(),e.skip(4),e.skip(4),t.Id=e.u32(),t}function oo(e){let t=new n(e),o={};return o.zoneStatusEffectDataList=t.array(t.u16(),()=>Ro(t),4),o}var no="PKTZoneStatusEffectAddNotify",ro=49467;function ao(e){let t=new n(e),o={};return t.skip(1),o.StatusEffectId=t.u32(),t.skip(1),o}var io="PKTZoneStatusEffectRemoveNotify",so=5255;var Do=new Map([[h,[v,E]],[_,[D,R]],[L,[B,A]],[M,[w,C]],[j,[F,O]],[z,[Z,V]],[W,[G,H]],[q,[$,Y]],[et,[tt,X]],[at,[rt,nt]],[ut,[st,it]],[ct,[mt,ft]],[bt,[yt,lt]],[Tt,[kt,Pt]],[Ut,[xt,St]],[Nt,[Kt,gt]],[vt,[Et,It]],[Dt,[Rt,ht]],[Bt,[At,_t]],[wt,[Ct,Lt]],[Ft,[Ot,Mt]],[Zt,[Vt,jt]],[Gt,[Ht,zt]],[$t,[Yt,Wt]],[Qt,[Jt,qt]],[ee,[te,Xt]],[re,[ne,oe]],[se,[ie,ae]],[me,[fe,ue]],[de,[pe,ce]],[be,[ye,le]],[Te,[ke,Pe]],[Ue,[xe,Se]],[Ne,[Ke,ge]],[ve,[Ee,Ie]],[De,[Re,he]],[Be,[Ae,_e]],[we,[Ce,Le]],[Fe,[Oe,Me]],[Ze,[Ve,je]],[Ge,[He,ze]],[$e,[Ye,We]],[Qe,[Je,qe]],[eo,[to,Xe]],[ro,[no,oo]],[so,[io,ao]]]);var _o=class extends Qo{#t;constructor(t){super(),this.#t=t}read(t){try{if(t.length<6)return!1;let o=t.readUInt8(5);if(o>2)return!1;let r=t.readUInt8(4);if(r>3)return!1;let i=t.subarray(6),u=t.readUInt16LE(2),m=Do.get(u);if(m){let[P,k]=m;this.emit(P,new uo(Buffer.from(i),u,r,!!o,this.#t,k))}this.emit("*",i,u,r,!!o)}catch{return!1}}},uo=class{#t;#o;#n;#r;#a;#i;constructor(t,o,r,i,u,m){this.#t=t,this.#o=o,this.#n=r,this.#r=i,this.#a=u,this.#i=m}#e;get parsed(){if(!this.#e)try{this.#e=this.#i(this.#a.decrypt(this.#t,this.#o,this.#n,this.#r))}catch(t){console.error(`[meter-core/pkt-stream] - ${t}`);return}return this.#e}};export{n as a,fo as b,h as c,_ as d,L as e,j as f,z as g,W as h,q as i,y as j,Pn as k,et as l,a as m,Sn as n,at as o,ut as p,ct as q,f as r,En as s,p as t,vn as u,bt as v,Tt as w,Ut as x,U as y,To as z,g as A,xo as B,Nt as C,vt as D,Dt as E,Bt as F,wt as G,Ft as H,Zt as I,Gt as J,$t as K,Qt as L,ee as M,re as N,se as O,me as P,Io as Q,fr as R,de as S,be as T,Te as U,ho as V,br as W,Ue as X,ve as Y,De as Z,Be as _,we as $,Fe as aa,Ze as ba,Ge as ca,$e as da,Qe as ea,eo as fa,ro as ga,so as ha,Do as ia,_o as ja,uo as ka};
